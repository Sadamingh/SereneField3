<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Time Series Analysis 3 | Computational Autocorrelation Function,  ACF Plot, and ADF Test</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Time Series Analysis 3 | Computational Autocorrelation Function,  ACF Plot, and ADF Test</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Time Series Analysis
</section>
<section data-field="body" class="e-content">
<section name="3a75" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="b4a0" id="b4a0" class="graf graf--h3 graf--leading graf--title">Time Series Analysis 3 | Computational Autocorrelation Function, ACF Plot, and ADF Test</h3><figure name="bab7" id="bab7" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*1zbB637Y1IyOoNVgCdYw-g.png" data-width="1356" data-height="758" src="https://cdn-images-1.medium.com/max/800/1*1zbB637Y1IyOoNVgCdYw-g.png"></figure><ol class="postList"><li name="6331" id="6331" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">Computational ACF</strong></li></ol><p name="7f94" id="7f94" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(1) Recall: Population/Theoretical ACF</strong></p><p name="66fd" id="66fd" class="graf graf--p graf-after--p">Recall the ACF of a time series {X_t} of population/theoretical should be,</p><figure name="14ad" id="14ad" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SYIW0pd9Rizz3N3ltji85w.png" data-width="1350" data-height="174" src="https://cdn-images-1.medium.com/max/800/1*SYIW0pd9Rizz3N3ltji85w.png"></figure><p name="a0e3" id="a0e3" class="graf graf--p graf-after--figure">Particularly, when {X_t} becomes stationary, the ACF will just depend on <em class="markup--em markup--p-em">h</em>,</p><figure name="6d64" id="6d64" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JplYBcsdFQ6Hw8BPpmxMww.png" data-width="1350" data-height="114" src="https://cdn-images-1.medium.com/max/800/1*JplYBcsdFQ6Hw8BPpmxMww.png"></figure><p name="f91e" id="f91e" class="graf graf--p graf-after--figure">So,</p><figure name="efb7" id="efb7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ANb447HTYG-ZX9j2b4k6iA.png" data-width="1336" data-height="108" src="https://cdn-images-1.medium.com/max/800/1*ANb447HTYG-ZX9j2b4k6iA.png"></figure><p name="48e7" id="48e7" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) Recall: The Definition of Correlation</strong></p><p name="7ad8" id="7ad8" class="graf graf--p graf-after--p">Recall for random variables X and Y, we have</p><figure name="56c6" id="56c6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*3TlA8go-oPlN8YM8Qs5VJQ.png" data-width="1346" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*3TlA8go-oPlN8YM8Qs5VJQ.png"></figure><p name="5941" id="5941" class="graf graf--p graf-after--figure">This is also,</p><figure name="0785" id="0785" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*66S1qbgTn22wfNSMlgwj6Q.png" data-width="1346" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*66S1qbgTn22wfNSMlgwj6Q.png"></figure><p name="18b2" id="18b2" class="graf graf--p graf-after--figure">So if we take a sample from X and a sample of Y, we use average to estimate the sample correlation. Then the formula becomes,</p><figure name="5b22" id="5b22" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*410GEVm57M5SeSrG3tOL_g.png" data-width="1346" data-height="288" src="https://cdn-images-1.medium.com/max/800/1*410GEVm57M5SeSrG3tOL_g.png"></figure><p name="b53a" id="b53a" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) Recall: Population/Theoretical ACVF</strong></p><p name="1480" id="1480" class="graf graf--p graf-after--p">Recall the population version ACVF is,</p><figure name="6286" id="6286" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*waGy6UhJd0BTL9zK7cSmAw.png" data-width="1346" data-height="114" src="https://cdn-images-1.medium.com/max/800/1*waGy6UhJd0BTL9zK7cSmAw.png"></figure><p name="6278" id="6278" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) Twisted Computational/Sample ACVF</strong></p><p name="1172" id="1172" class="graf graf--p graf-after--p">If we use the <strong class="markup--strong markup--p-strong">same sample size</strong> for <em class="markup--em markup--p-em">t+h</em> and <em class="markup--em markup--p-em">t</em> here, and this is, therefore, called a first twisted ACF (means the result can be biased). Based on the previous discussion, the sample version 1st twisted ACF should be,</p><figure name="1d37" id="1d37" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Z5CCAo5m75sPxXM3_n1DrA.png" data-width="1346" data-height="114" src="https://cdn-images-1.medium.com/max/800/1*Z5CCAo5m75sPxXM3_n1DrA.png"></figure><p name="2f31" id="2f31" class="graf graf--p graf-after--figure">For simplification, if we use the <strong class="markup--strong markup--p-strong">same sample</strong> <strong class="markup--strong markup--p-strong">mean</strong> for {X_t} and {X_(t+h)}, we are using a second twisted version ACF. However, this case also has a downside because we just use the ground mean of the whole sample, and this is not very accurate.</p><figure name="2d44" id="2d44" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*mpmByH-pt3QY64YRj_hfxw.png" data-width="1346" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*mpmByH-pt3QY64YRj_hfxw.png"></figure><p name="6c9d" id="6c9d" class="graf graf--p graf-after--figure">The 3rd twisted version should be even simpler because we don’t want <em class="markup--em markup--p-em">h</em> to impact the outcome. Therefore, we just use n+1 in the denominator.</p><figure name="6259" id="6259" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_0116OmXD92ZUId92mkUEQ.png" data-width="1346" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*_0116OmXD92ZUId92mkUEQ.png"></figure><p name="b0b5" id="b0b5" class="graf graf--p graf-after--figure">Note we have n+1 here because we assumed our time series from t=0. So there are n+1 elements. So generally, the sample ACVF we are going to use is the 3rd twisted version. Because of all the twists we have added, the sample ACVF is <strong class="markup--strong markup--p-strong">NOT an unbiased estimate</strong> of the population ACVF.</p><p name="d759" id="d759" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(5) Computational/Sample ACF</strong></p><p name="5967" id="5967" class="graf graf--p graf-after--p">What’s more, this ACVF result used the assumption that {X_t} is <strong class="markup--strong markup--p-strong">stationary</strong> even when {X_t} is not necessarily stationary. So why do we do that? This is because it does give an approximate estimate of the autocorrelation, and more importantly, it reflects the change of seasonality in the time series.</p><p name="5cd2" id="5cd2" class="graf graf--p graf-after--p">So, we can still confirm the sample ACF function as,</p><figure name="8b66" id="8b66" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Bquosfa5pEh0uWyjVIpxFg.png" data-width="1346" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*Bquosfa5pEh0uWyjVIpxFg.png"></figure><p name="028b" id="028b" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. ACF Plot</strong></p><p name="c22c" id="c22c" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) The Definition of ACF Plot</strong></p><p name="db4e" id="db4e" class="graf graf--p graf-after--p">The ACF plot of a sample is its autocorrelation values against the lag <em class="markup--em markup--p-em">h</em>. The key point of doing this is to know how ACF behaves differently with different time series so that we can detect the type of time series based on its ACF plot.</p><p name="afac" id="afac" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(2) Static Starting Point of (0, 1)</strong></p><p name="6ee4" id="6ee4" class="graf graf--p graf-after--p">If we start at <em class="markup--em markup--p-em">h </em>= 0, then the ρ(0) should always be 1. So for any ACF plot, we can always find the plot starts from the point (0, 1).</p><p name="095a" id="095a" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(3) How to Read ACF Plot?</strong></p><p name="3eaa" id="3eaa" class="graf graf--p graf-after--p">With <em class="markup--em markup--p-em">h</em> going up to n, the sample ACF can become very small and doesn’t reflect the real ACF anymore. So when plotting the ACF, we always follow these two steps,</p><ul class="postList"><li name="e1a3" id="e1a3" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">General View</strong>: plot ACF with h approximately equals n to see observe the general changes</li><li name="6a30" id="6a30" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Zoom in</strong>: then zoom in with smaller h for only the beginning part of an ACF plot to get a more reliable conclusion.</li></ul><p name="eb3f" id="eb3f" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(4) White Noise ACF Plot Example</strong></p><ul class="postList"><li name="f560" id="f560" class="graf graf--li graf-after--p">Has (0, 1) point, but suddenly drop after that point</li><li name="831e" id="831e" class="graf graf--li graf-after--li">Random patterns in the rest of the ACF plot, commonly with autocorrelation between -0.2 ~ 0.2. This means a weak correlation.</li></ul><figure name="73ca" id="73ca" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*_TChsQmWp2vXw731sA6MXw.png" data-width="787" data-height="184" src="https://cdn-images-1.medium.com/max/800/1*_TChsQmWp2vXw731sA6MXw.png"></figure><p name="cee9" id="cee9" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(5) Stationary Time Series AR(<em class="markup--em markup--p-em">p</em>), MA(<em class="markup--em markup--p-em">q</em>), ARMA(<em class="markup--em markup--p-em">p</em>, <em class="markup--em markup--p-em">q</em>) Example</strong></p><p name="8310" id="8310" class="graf graf--p graf-after--p">If ACF doesn’t show the behavior with the <strong class="markup--strong markup--p-strong">obvious trend</strong> and <strong class="markup--strong markup--p-strong">obvious seasonality</strong>, then it is stationary.</p><p name="f938" id="f938" class="graf graf--p graf-after--p">The ACF of AR should be (when coef ϕ &gt; 0 but stationary, e.g. ϕ = 0.8),</p><figure name="ddc4" id="ddc4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RNjZi_k-KhBBhiLPEZRJ-Q.png" data-width="828" data-height="188" src="https://cdn-images-1.medium.com/max/800/1*RNjZi_k-KhBBhiLPEZRJ-Q.png"></figure><p name="aedf" id="aedf" class="graf graf--p graf-after--figure">Or (when coef ϕ &lt; 0 but stationary, e.g. ϕ = -1.2),</p><figure name="4bd3" id="4bd3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*W1EEB1DDOoXzuKO7LA15vg.png" data-width="710" data-height="175" src="https://cdn-images-1.medium.com/max/800/1*W1EEB1DDOoXzuKO7LA15vg.png"></figure><p name="c140" id="c140" class="graf graf--p graf-after--figure">The ACF of MA should be,</p><figure name="5da7" id="5da7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*0fsO8QCkTHWDBT9L9PSgCw.png" data-width="828" data-height="188" src="https://cdn-images-1.medium.com/max/800/1*0fsO8QCkTHWDBT9L9PSgCw.png"><figcaption class="imageCaption">sudden shut off compared with AR</figcaption></figure><p name="bff5" id="bff5" class="graf graf--p graf-after--figure">The ACF plot of ARMA (general stationary time series) should be,</p><figure name="dbff" id="dbff" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*sdiidg6VHa13YM1cFP5aJg.png" data-width="828" data-height="391" src="https://cdn-images-1.medium.com/max/800/1*sdiidg6VHa13YM1cFP5aJg.png"></figure><p name="ac0a" id="ac0a" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(6) Obvious Trend Time Series ACF Plot Example</strong></p><p name="8e11" id="8e11" class="graf graf--p graf-after--p">So what is the obvious trend and seasonality? Let’s talk about them now.</p><figure name="bfb1" id="bfb1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QhuIE7l6Wz7QapDtVNoPUg.png" data-width="828" data-height="189" src="https://cdn-images-1.medium.com/max/800/1*QhuIE7l6Wz7QapDtVNoPUg.png"></figure><p name="6bca" id="6bca" class="graf graf--p graf-after--figure">Looking at each pair’s relationship with the average value, when <em class="markup--em markup--p-em">h</em> is smaller, we have more positive terms in the sum, this will result in a larger ρ(h)-cap value. Then ρ(h)-cap will keep decreasing and the ACF value drops down. So But finally, it pulls back a little bit in the end. Why? This is because we have fewer terms but the sample size is still large. In the end, it may finally become the noise.</p><p name="1d09" id="1d09" class="graf graf--p graf-after--p">So the features of this kind of time series should be,</p><ul class="postList"><li name="2f9f" id="2f9f" class="graf graf--li graf-after--p">Start from (0, 1)</li><li name="05f0" id="05f0" class="graf graf--li graf-after--li">ACF value drop down to negative because we have more and more negative terms and fewer positive terms when calculating ACF</li><li name="29de" id="29de" class="graf graf--li graf-after--li">It pulls back a little bit because of fewer terms</li><li name="808c" id="808c" class="graf graf--li graf-after--li">Finally, become noises (may not appear)</li></ul><p name="3a0a" id="3a0a" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(7) Other Trend Time Series</strong></p><ul class="postList"><li name="9c60" id="9c60" class="graf graf--li graf-after--p">Think about a TS going down. Will the plot change?</li></ul><p name="4e08" id="4e08" class="graf graf--p graf-after--li">No. This is because we still start from (0, 1), and the sign correlation should remain the same. The only difference is that we have negative multipliers in the first place but their products are still positive when <em class="markup--em markup--p-em">h</em> is small.</p><figure name="8b80" id="8b80" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ZVTEJGNRB2lO-Gwbvamy9w.png" data-width="828" data-height="189" src="https://cdn-images-1.medium.com/max/800/1*ZVTEJGNRB2lO-Gwbvamy9w.png"></figure><ul class="postList"><li name="713f" id="713f" class="graf graf--li graf-after--figure">Think about a curved TS. Why it shows this way? Think about it yourself.</li></ul><figure name="c283" id="c283" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*szbD0LI_4e3tZVvZdDMVUg.png" data-width="828" data-height="189" src="https://cdn-images-1.medium.com/max/800/1*szbD0LI_4e3tZVvZdDMVUg.png"></figure><p name="da16" id="da16" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(8) Obvious Seasonality Time Series ACF Plot Example</strong></p><p name="de70" id="de70" class="graf graf--p graf-after--p">If h increases, the ACF value gets smaller, but the seasonal pattern remains. So the ACF plot of a seasonality time series model should be,</p><figure name="32e0" id="32e0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ge8FrgQuCXeqoFflUujSwA.png" data-width="828" data-height="189" src="https://cdn-images-1.medium.com/max/800/1*ge8FrgQuCXeqoFflUujSwA.png"></figure><p name="c286" id="c286" class="graf graf--p graf-after--figure">This plot has the following features,</p><ul class="postList"><li name="aa1d" id="aa1d" class="graf graf--li graf-after--p">Start from (0, 1)</li><li name="ad3b" id="ad3b" class="graf graf--li graf-after--li">Lag of two peaks or two troughs has a positive ACF value</li><li name="cf30" id="cf30" class="graf graf--li graf-after--li">Lag of a peak and a trough has a negative ACF value</li><li name="c8e6" id="c8e6" class="graf graf--li graf-after--li">Alternate periods of positive and negative ACF values</li></ul><p name="60c7" id="60c7" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(9) Obvious Trend and Seasonality Time Series ACF Plot Example</strong></p><p name="fd5e" id="fd5e" class="graf graf--p graf-after--p">This is probably the most common kind of time series plot we can generate from a real dataset.</p><figure name="1f6e" id="1f6e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*jR83vJCPTOCanX2ztP7Zsw.png" data-width="828" data-height="188" src="https://cdn-images-1.medium.com/max/800/1*jR83vJCPTOCanX2ztP7Zsw.png"></figure><p name="819e" id="819e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">3. Augmented Dicky-Fuller (ADF) Test</strong></p><p name="86a7" id="86a7" class="graf graf--p graf-after--p">By default,</p><ul class="postList"><li name="5270" id="5270" class="graf graf--li graf-after--p">H0: the time series is not stationary</li><li name="da08" id="da08" class="graf graf--li graf-after--li">H1: the time series is stationary</li></ul><p name="14a3" id="14a3" class="graf graf--p graf-after--li">By assuming <code class="markup--code markup--p-code">AR(1)</code> condition,</p><figure name="6399" id="6399" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*x8zB5XzJhL3Y9IkDJzQoBw.png" data-width="1338" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*x8zB5XzJhL3Y9IkDJzQoBw.png"></figure><p name="2c36" id="2c36" class="graf graf--p graf-after--figure">Then the original hypotheses are equivalent to,</p><ul class="postList"><li name="d972" id="d972" class="graf graf--li graf-after--p">H0: |ϕ| ≥ 1 (Based on the proof of AR(1) stationary conditions)</li><li name="4f19" id="4f19" class="graf graf--li graf-after--li">H1: |ϕ| &lt; 1</li></ul><p name="6ea9" id="6ea9" class="graf graf--p graf-after--li graf--trailing">When the P-value of the ADF test is less than 0.05 (assume the confidence level is 95%), we can reject the null hypothesis, and the current time series under testing is a stationary time series. In practice, the ADF test is good at picking out time series with trends as non-stationary, but it is bad at picking out time series with only seasonality as non-stationary.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/fe3d5cdf736e"><time class="dt-published" datetime="2021-11-04T16:42:13.181Z">November 4, 2021</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/time-series-analysis-3-computational-autocorrelation-function-acf-plot-and-adf-test-fe3d5cdf736e" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>