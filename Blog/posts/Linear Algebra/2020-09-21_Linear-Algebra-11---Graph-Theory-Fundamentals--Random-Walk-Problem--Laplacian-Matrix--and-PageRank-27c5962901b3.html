<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Linear Algebra 11 | Graph Theory Fundamentals, Random Walk Problem, Laplacian Matrix, and PageRank</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Linear Algebra 11 | Graph Theory Fundamentals, Random Walk Problem, Laplacian Matrix, and PageRank</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Linear Algebra
</section>
<section data-field="body" class="e-content">
<section name="3a85" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5ac6" id="5ac6" class="graf graf--h3 graf--leading graf--title">Linear Algebra 11 | Graph Theory Fundamentals, Random Walk Problem, <strong class="markup--strong markup--h3-strong">Laplacian Matrix, </strong>and Google’s Pagerank Algorithm</h3><figure name="f4c6" id="f4c6" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*Yj4DEKztkbPyDrnciYX9dQ.jpeg" data-width="1955" data-height="1296" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*Yj4DEKztkbPyDrnciYX9dQ.jpeg"></figure><ol class="postList"><li name="caae" id="caae" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">Fundamental of Graphs</strong></li></ol><p name="f074" id="f074" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(1) The Definition of Vertex (aka. Node)</strong></p><p name="e1a6" id="e1a6" class="graf graf--p graf-after--p">The vertex is a point where multiple lines meet, it is also known as the node.</p><figure name="a0f6" id="a0f6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pVxlUBomke3pz7gKgTdR7A.png" data-width="1618" data-height="122" src="https://cdn-images-1.medium.com/max/800/1*pVxlUBomke3pz7gKgTdR7A.png"></figure><p name="4012" id="4012" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) The Definition of Edge</strong></p><p name="f75a" id="f75a" class="graf graf--p graf-after--p">The line that connects two vertices is called the edge.</p><figure name="8d63" id="8d63" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Y1dNyy5mauzKHB_xCjGc8w.png" data-width="2114" data-height="294" src="https://cdn-images-1.medium.com/max/800/1*Y1dNyy5mauzKHB_xCjGc8w.png"></figure><p name="6545" id="6545" class="graf graf--p graf-after--figure">If there are more than one edges connecting two vertices, then these edges are called parallel edges.</p><figure name="5962" id="5962" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HHz_dtt-pSlNJlh_IA422Q.png" data-width="2066" data-height="410" src="https://cdn-images-1.medium.com/max/800/1*HHz_dtt-pSlNJlh_IA422Q.png"></figure><p name="962e" id="962e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) The Definition of Graph</strong></p><p name="ad11" id="ad11" class="graf graf--p graf-after--p">As discussed in the previous section, the graph is a combination of vertices (nodes) and edges. <strong class="markup--strong markup--p-strong">G</strong> = (<strong class="markup--strong markup--p-strong">V</strong>, <strong class="markup--strong markup--p-strong">E</strong>) where <strong class="markup--strong markup--p-strong">V</strong> represents the set of all vertices and <strong class="markup--strong markup--p-strong">E</strong> represents the set of all edges of the graph.</p><figure name="dbe8" id="dbe8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*B5DkqQ7E-z3mGq2viYeHwg.png" data-width="2114" data-height="428" src="https://cdn-images-1.medium.com/max/800/1*B5DkqQ7E-z3mGq2viYeHwg.png"></figure><p name="7ea3" id="7ea3" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) The Definition of Degree</strong></p><p name="97c4" id="97c4" class="graf graf--p graf-after--p">The number of edges connected to a vertex is called the degree of this vertex. It is noted as deg(vertex). For example, in the graph above, the degree of node 1 is 2, and the degree of node 2 is 3.</p><p name="ccdc" id="ccdc" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(5) The Adjacency Matrix of a Graph</strong></p><p name="27b9" id="27b9" class="graf graf--p graf-after--p">To some extent, a graph is also a matrix. Suppose we have got a graph G with <em class="markup--em markup--p-em">n</em> nodes, then it can be written as an <em class="markup--em markup--p-em">n</em> × <em class="markup--em markup--p-em">n</em> matrix if it satisfies,</p><figure name="eb56" id="eb56" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*-sMSoesv4AS0rJLqDmXnbA.png" data-width="1536" data-height="176" src="https://cdn-images-1.medium.com/max/800/1*-sMSoesv4AS0rJLqDmXnbA.png"></figure><p name="f5a0" id="f5a0" class="graf graf--p graf-after--figure">This is called the adjacency matrix of the graph G.</p><p name="556e" id="556e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(6) The Definition of the Null Graph</strong></p><p name="18da" id="18da" class="graf graf--p graf-after--p">For a given graph <strong class="markup--strong markup--p-strong">G</strong> = (<strong class="markup--strong markup--p-strong">V</strong>, <strong class="markup--strong markup--p-strong">E</strong>), if <strong class="markup--strong markup--p-strong">E</strong> = <strong class="markup--strong markup--p-strong">∅</strong>, then this graph is called a null graph.</p><figure name="2416" id="2416" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*J6McI_Cq_avh6Xrxw_RAgg.png" data-width="2066" data-height="410" src="https://cdn-images-1.medium.com/max/800/1*J6McI_Cq_avh6Xrxw_RAgg.png"></figure><p name="5a50" id="5a50" class="graf graf--p graf-after--figure">The adjacency matrix of a null graph is a null matrix with all the entities in it equals zero.</p><figure name="0596" id="0596" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9qb8QRa7racsNxu3Q4Ybdg.png" data-width="1686" data-height="264" src="https://cdn-images-1.medium.com/max/800/1*9qb8QRa7racsNxu3Q4Ybdg.png"></figure><p name="5b75" id="5b75" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(7) The Definition of the Non-Directed Graph</strong></p><p name="9e54" id="9e54" class="graf graf--p graf-after--p">The non-directed graphs are the graphs that have edges, but these edges do not have any particular direction.</p><figure name="4b2b" id="4b2b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*7lenELwWDrs194fCRJd0GQ.png" data-width="1360" data-height="272" src="https://cdn-images-1.medium.com/max/800/1*7lenELwWDrs194fCRJd0GQ.png"></figure><p name="2e9c" id="2e9c" class="graf graf--p graf-after--figure">It is quite clear that the adjacency matrix form of a non-directed graph must be a symmetric matrix because the edge that connecting node <em class="markup--em markup--p-em">i</em> to node <em class="markup--em markup--p-em">j</em> must connect node <em class="markup--em markup--p-em">j</em> with node <em class="markup--em markup--p-em">i</em>.</p><p name="d103" id="d103" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(8) The Definition of the Directed Graph</strong></p><p name="59c5" id="59c5" class="graf graf--p graf-after--p">When the edges of a graph have a specific direction, they are called directed graphs.</p><figure name="9bb8" id="9bb8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JjhRuteRaA7I8beNaIvAsg.png" data-width="1406" data-height="364" src="https://cdn-images-1.medium.com/max/800/1*JjhRuteRaA7I8beNaIvAsg.png"></figure><p name="c9e0" id="c9e0" class="graf graf--p graf-after--figure">The adjacency matrix of a directed graph must be asymmetric, because if the matrix of a directed graph is a symmetric matrix, then it turns out to be a non-directed graph instead of a directed graph.</p><p name="8a0d" id="8a0d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(9) The Definition of the Disconnected Graph</strong></p><p name="5be6" id="5be6" class="graf graf--p graf-after--p">Starting from one point, if we have unreachable vertex(s), i.e., a path does not exist between every pair of vertices, then this graph is a disconnected graph.</p><figure name="6c36" id="6c36" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*tTGrRldS9EAWwFveeyTCiQ.png" data-width="1462" data-height="340" src="https://cdn-images-1.medium.com/max/800/1*tTGrRldS9EAWwFveeyTCiQ.png"></figure><p name="4e16" id="4e16" class="graf graf--p graf-after--figure">The adjacency matrix of this kind of graph is quite interesting because we have the upper right partial matrix and the lower-left partial matrix equals the null matrix (or zero) if the nodes are ordered by the order of the clusters.</p><figure name="8812" id="8812" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ybK6GF-idRZqEg8ZFlG5jA.png" data-width="1986" data-height="316" src="https://cdn-images-1.medium.com/max/800/1*ybK6GF-idRZqEg8ZFlG5jA.png"></figure><p name="453c" id="453c" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(10) The Definition of the Connected Graph</strong></p><p name="01fd" id="01fd" class="graf graf--p graf-after--p">Starting from one point, when there is no unreachable vertex(s), then this graph is a connected graph. For example,</p><figure name="0773" id="0773" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Ga_sUXbqUHhvRZC3yh3Isw.png" data-width="1438" data-height="316" src="https://cdn-images-1.medium.com/max/800/1*Ga_sUXbqUHhvRZC3yh3Isw.png"></figure><p name="8ef4" id="8ef4" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(11) The Inner Degree and The Outer Degree</strong></p><p name="4e6e" id="4e6e" class="graf graf--p graf-after--p">In a directed graph, the inner degree of a vertex equals the number of edges pointing to this vertex, while the outer degree of a vertex equals the number of edges pointing out of this vertex. For example, the following vertex has an inner degree equal to 4 and an outer degree equal to 5.</p><figure name="0fd1" id="0fd1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hUX0QTiVX87K1tSo7T6FAA.png" data-width="1656" data-height="432" src="https://cdn-images-1.medium.com/max/800/1*hUX0QTiVX87K1tSo7T6FAA.png"></figure><p name="e9de" id="e9de" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. The Random Walk Problem</strong></p><p name="60cd" id="60cd" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Difference Equation of the Random Walk Problem</strong></p><p name="c09a" id="c09a" class="graf graf--p graf-after--p">Recalling the last section when we talked about the weather forecast problem, the diagram we drew is actually a directed graph. To think about the random walk problem, we can start our settings with a directed graph as well. Suppose that we have a randomly chosen starting point, which can be represented by the probability of each point that we may locate.</p><p name="72a2" id="72a2" class="graf graf--p graf-after--p">Suppose we have <em class="markup--em markup--p-em">n</em> nodes in a graph and we start from a random point and for each of these nodes, they have a different probability of being selected as the starting point {<strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong>1, <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong>2, …, <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong>n}. Thus, the original state should be,</p><figure name="b16d" id="b16d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*5HHEdyK4WtuohJmPauowSw.png" data-width="1250" data-height="190" src="https://cdn-images-1.medium.com/max/800/1*5HHEdyK4WtuohJmPauowSw.png"></figure><p name="fbca" id="fbca" class="graf graf--p graf-after--figure">Suppose we are now located on the node <em class="markup--em markup--p-em">i</em>, which has an edge directing from <em class="markup--em markup--p-em">i </em>to<em class="markup--em markup--p-em"> j</em>, and it also has an edge that directs from <em class="markup--em markup--p-em">t</em> to <em class="markup--em markup--p-em">i</em>. The inner degree and the outer degree of node <em class="markup--em markup--p-em">i</em> are both equal to 1.</p><figure name="146b" id="146b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bSZLhz2zZElcBy-UypsQJA.png" data-width="1856" data-height="144" src="https://cdn-images-1.medium.com/max/800/1*bSZLhz2zZElcBy-UypsQJA.png"></figure><p name="cab4" id="cab4" class="graf graf--p graf-after--figure">In this specific case, we must come from node <em class="markup--em markup--p-em">t</em> and we must go to node <em class="markup--em markup--p-em">j </em>with no other choices. That is to say that we have a 100% chance to go from <em class="markup--em markup--p-em">t</em> to <em class="markup--em markup--p-em">i</em> and also from <em class="markup--em markup--p-em">i</em> to <em class="markup--em markup--p-em">j</em>. Now if we have another vertex <em class="markup--em markup--p-em">r</em> and there is an edge pointing from <em class="markup--em markup--p-em">i </em>to <em class="markup--em markup--p-em">r</em>. Then we will have a 50% chance to go from <em class="markup--em markup--p-em">i</em> to <em class="markup--em markup--p-em">j </em>and also a 50% chance to go from <em class="markup--em markup--p-em">i</em> to <em class="markup--em markup--p-em">r.</em></p><figure name="387a" id="387a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*w2hFonBpRRuSd5odfcqSOg.png" data-width="1856" data-height="340" src="https://cdn-images-1.medium.com/max/800/1*w2hFonBpRRuSd5odfcqSOg.png"></figure><p name="f1f0" id="f1f0" class="graf graf--p graf-after--figure">Therefore, we can conclude that the probability of the next point after node <em class="markup--em markup--p-em">i</em> is exactly 1 divided by the outer degree of vertex <em class="markup--em markup--p-em">i</em>.</p><figure name="1a23" id="1a23" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Rmvg4RWylt7kbpTQfr1rTQ.png" data-width="1666" data-height="108" src="https://cdn-images-1.medium.com/max/800/1*Rmvg4RWylt7kbpTQfr1rTQ.png"></figure><p name="4f08" id="4f08" class="graf graf--p graf-after--figure">Suppose we use <em class="markup--em markup--p-em">g</em>ij for whether or not we have an edge that points from<em class="markup--em markup--p-em"> i</em> to <em class="markup--em markup--p-em">j</em>, then because the event that <em class="markup--em markup--p-em">g</em>ij and to go from <em class="markup--em markup--p-em">i</em> to j is independent. So then we have,</p><figure name="03b9" id="03b9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_7ELjXDdhqEy9kVmr1VvSA.png" data-width="1454" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*_7ELjXDdhqEy9kVmr1VvSA.png"></figure><p name="1a24" id="1a24" class="graf graf--p graf-after--figure">If we are at the state <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong>t, then we can write the difference equation of the state <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong>t+1 as,</p><figure name="c208" id="c208" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*sYn-zEI36DNJK5M0oM3mjw.png" data-width="1334" data-height="256" src="https://cdn-images-1.medium.com/max/800/1*sYn-zEI36DNJK5M0oM3mjw.png"></figure><p name="b9ee" id="b9ee" class="graf graf--p graf-after--figure">Write this difference equation as its matrix form, we can have,</p><figure name="ecd7" id="ecd7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*mWo0e2dsy_9EAeWlnvLdkw.png" data-width="1168" data-height="196" src="https://cdn-images-1.medium.com/max/800/1*mWo0e2dsy_9EAeWlnvLdkw.png"></figure><p name="2dd1" id="2dd1" class="graf graf--p graf-after--figure">Because we have known that all the probability of <em class="markup--em markup--p-em">i</em> to <em class="markup--em markup--p-em">j</em> is exactly 1 divided by the outer degree of vertex <em class="markup--em markup--p-em">i</em>. Therefore,</p><figure name="ed6f" id="ed6f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*PYRZ4JRJFSFUZKNS8NzEVw.png" data-width="1348" data-height="108" src="https://cdn-images-1.medium.com/max/800/1*PYRZ4JRJFSFUZKNS8NzEVw.png"></figure><p name="8bf7" id="8bf7" class="graf graf--p graf-after--figure">Then, the equation system can be written as,</p><figure name="8ed6" id="8ed6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*7O8J8BZqq8h1w5LJxFhp5g.png" data-width="1246" data-height="288" src="https://cdn-images-1.medium.com/max/800/1*7O8J8BZqq8h1w5LJxFhp5g.png"></figure><p name="1260" id="1260" class="graf graf--p graf-after--figure">This is also,</p><figure name="0195" id="0195" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*K0M40tfgbkWh1UemfFAGGQ.png" data-width="1554" data-height="198" src="https://cdn-images-1.medium.com/max/800/1*K0M40tfgbkWh1UemfFAGGQ.png"></figure><p name="fcdd" id="fcdd" class="graf graf--p graf-after--figure">We can find out that the matrix consisted of <em class="markup--em markup--p-em">g</em>ij is exactly the definition of the adjacency matrix of the directed graph G, therefore, if we define that,</p><figure name="ef5a" id="ef5a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*FipFQH5ZOPrzH3dt1izfjA.png" data-width="1280" data-height="196" src="https://cdn-images-1.medium.com/max/800/1*FipFQH5ZOPrzH3dt1izfjA.png"></figure><p name="f7c8" id="f7c8" class="graf graf--p graf-after--figure">Then,</p><figure name="ad7a" id="ad7a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*eUJXHQOSgzeMUwYNFSu--w.png" data-width="1320" data-height="198" src="https://cdn-images-1.medium.com/max/800/1*eUJXHQOSgzeMUwYNFSu--w.png"></figure><p name="e1b6" id="e1b6" class="graf graf--p graf-after--figure">Suppose we define the diagonal matrix <strong class="markup--strong markup--p-strong">D</strong> as our <strong class="markup--strong markup--p-strong">degree matrix</strong>,</p><figure name="7532" id="7532" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*zJ62gTELnvn1m-GWl5T2mQ.png" data-width="1162" data-height="198" src="https://cdn-images-1.medium.com/max/800/1*zJ62gTELnvn1m-GWl5T2mQ.png"></figure><p name="cc35" id="cc35" class="graf graf--p graf-after--figure">then based on the property of the diagonal matrix, we can have,</p><figure name="244f" id="244f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*OTVECZWtnFf7KNnM3EPDKg.png" data-width="1254" data-height="198" src="https://cdn-images-1.medium.com/max/800/1*OTVECZWtnFf7KNnM3EPDKg.png"></figure><p name="cf0d" id="cf0d" class="graf graf--p graf-after--figure">this is to say that, for the difference equation system, we can then have,</p><figure name="3cda" id="3cda" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*GLyXZ9hUFN6qFgb7UrmNsA.png" data-width="1106" data-height="196" src="https://cdn-images-1.medium.com/max/800/1*GLyXZ9hUFN6qFgb7UrmNsA.png"></figure><p name="e03e" id="e03e" class="graf graf--p graf-after--figure">this is also,</p><figure name="5439" id="5439" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_XmfNKkwchAVyhDjrjDNGw.png" data-width="1360" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*_XmfNKkwchAVyhDjrjDNGw.png"></figure><p name="36fb" id="36fb" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) Proof of the Stochastic Matrix GD^(-1)</strong></p><p name="d5ff" id="d5ff" class="graf graf--p graf-after--p">By definition of the inner product, we have,</p><figure name="96cb" id="96cb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*yXuL54p6a7QHiYMQ3LCjkw.png" data-width="1162" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*yXuL54p6a7QHiYMQ3LCjkw.png"></figure><p name="4444" id="4444" class="graf graf--p graf-after--figure">Also, we have the expression of <strong class="markup--strong markup--p-strong">GD</strong>^(-1) as,</p><figure name="3494" id="3494" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QthqbphtsLl6RvtyEqr6rw.png" data-width="1246" data-height="288" src="https://cdn-images-1.medium.com/max/800/1*QthqbphtsLl6RvtyEqr6rw.png"></figure><p name="9033" id="9033" class="graf graf--p graf-after--figure">The sum of the entries in each of these columns should be,</p><figure name="ce4e" id="ce4e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UoU4IqadmvrE5eKLaa8GIQ.png" data-width="1246" data-height="118" src="https://cdn-images-1.medium.com/max/800/1*UoU4IqadmvrE5eKLaa8GIQ.png"></figure><p name="bb17" id="bb17" class="graf graf--p graf-after--figure">Therefore, the matrix <strong class="markup--strong markup--p-strong">GD</strong>^(-1) is a stochastic matrix. Recall the property of the stochastic matrix, we can know that this matrix has a stable state <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong>.</p><p name="abb4" id="abb4" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(3) Solve the Stable State of the Random Walk Problem</strong></p><p name="048a" id="048a" class="graf graf--p graf-after--p">The stable state of the random walk problem gives us a final state of probabilities of each vertex. Suppose we have a stable state <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong> and this stable state can have the property that,</p><figure name="1ce0" id="1ce0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9rmcKDKLRaQhrVoymcHpwA.png" data-width="1246" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*9rmcKDKLRaQhrVoymcHpwA.png"></figure><p name="bc18" id="bc18" class="graf graf--p graf-after--figure">then,</p><figure name="b9df" id="b9df" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*sEXmJj6USwa9QuC-Hsu2TA.png" data-width="1246" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*sEXmJj6USwa9QuC-Hsu2TA.png"></figure><p name="7fb5" id="7fb5" class="graf graf--p graf-after--figure">then,</p><figure name="2e11" id="2e11" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*oCHPQvScjhfDZ95bu0kVlA.png" data-width="1246" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*oCHPQvScjhfDZ95bu0kVlA.png"></figure><p name="577f" id="577f" class="graf graf--p graf-after--figure">then,</p><figure name="1ebe" id="1ebe" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Me27YkKV1xQX4kjG1_S25A.png" data-width="1246" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*Me27YkKV1xQX4kjG1_S25A.png"></figure><p name="e4ef" id="e4ef" class="graf graf--p graf-after--figure">then,</p><figure name="1d77" id="1d77" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*eHpvpCJ_vbhcmK7LWhQ7Vw.png" data-width="1246" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*eHpvpCJ_vbhcmK7LWhQ7Vw.png"></figure><p name="00c2" id="00c2" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) The Definition of the Laplacian Matrix</strong></p><p name="1510" id="1510" class="graf graf--p graf-after--p">Suppose we have the adjacent matrix <strong class="markup--strong markup--p-strong">A</strong> of Graph <strong class="markup--strong markup--p-strong">G</strong>, and we also have the degree matrix noted as <strong class="markup--strong markup--p-strong">D</strong>. Then the Laplacian matrix is defined by,</p><figure name="74d3" id="74d3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*i0Olxo8OP0-PpIvp5Q0OXw.png" data-width="1246" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*i0Olxo8OP0-PpIvp5Q0OXw.png"></figure><p name="ea86" id="ea86" class="graf graf--p graf-after--figure">If we have a non-directed graph (which means the outer degrees equal the inner degree) and there is no self-connected vertex (which means the main diagonal entries of <strong class="markup--strong markup--p-strong">A </strong>are 0). Then we can have,</p><figure name="7c08" id="7c08" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*GY5ilTJUOF5zs8bUHlIxhA.png" data-width="1170" data-height="204" src="https://cdn-images-1.medium.com/max/800/1*GY5ilTJUOF5zs8bUHlIxhA.png"></figure><p name="3022" id="3022" class="graf graf--p graf-after--figure">then,</p><figure name="957c" id="957c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*XntBk4CpCwkNgDpNbU3Y5w.png" data-width="1224" data-height="192" src="https://cdn-images-1.medium.com/max/800/1*XntBk4CpCwkNgDpNbU3Y5w.png"></figure><p name="2cac" id="2cac" class="graf graf--p graf-after--figure">So in general, for a non-directed graph, the entries in the Laplacian matrix are,</p><figure name="6901" id="6901" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ROIIhc8gFlCIe54Is5nsBQ.png" data-width="1326" data-height="214" src="https://cdn-images-1.medium.com/max/800/1*ROIIhc8gFlCIe54Is5nsBQ.png"></figure><p name="0709" id="0709" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(5) Solve the Stable State of the Random Walk Problem (Continue)</strong></p><p name="a5fa" id="a5fa" class="graf graf--p graf-after--p">Based on the previous discussion,</p><figure name="e4a3" id="e4a3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*eHpvpCJ_vbhcmK7LWhQ7Vw.png" data-width="1246" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*eHpvpCJ_vbhcmK7LWhQ7Vw.png"></figure><p name="7924" id="7924" class="graf graf--p graf-after--figure">then, by Laplacian matrix,</p><figure name="cab9" id="cab9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HFo4zMXicd02D_5xaxH24A.png" data-width="1326" data-height="80" src="https://cdn-images-1.medium.com/max/800/1*HFo4zMXicd02D_5xaxH24A.png"></figure><p name="efdb" id="efdb" class="graf graf--p graf-after--figure">this is also,</p><figure name="77ee" id="77ee" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*VAhNQMqppwLgf6DDQ4c_2Q.png" data-width="1326" data-height="80" src="https://cdn-images-1.medium.com/max/800/1*VAhNQMqppwLgf6DDQ4c_2Q.png"></figure><p name="e127" id="e127" class="graf graf--p graf-after--figure">If we want to solve the stable state by this equation, this can be hard to calculate because this is going to take a long time for calculation. So have we got some easier methods?</p><p name="c971" id="c971" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(6) Recall: The Power Method</strong></p><p name="61be" id="61be" class="graf graf--p graf-after--p">In the last section, for any given stochastic matrix <strong class="markup--strong markup--p-strong">M</strong>, if we power this matrix with N times and limit N to infinite, then it will give us the result of the stable state. A rigorous proof is as follows.</p><p name="11d2" id="11d2" class="graf graf--p graf-after--p">Proof:</p><p name="03e8" id="03e8" class="graf graf--p graf-after--p">Given a stochastic matrix <strong class="markup--strong markup--p-strong">M</strong>, and given ∀ vector <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">x</em></strong> in ℝⁿ.</p><p name="2a9e" id="2a9e" class="graf graf--p graf-after--p">Suppose {<strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">v</em></strong>1, <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">v</em></strong>2, …, <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">v</em></strong>n} is a basis of ℝⁿ space and these vectors are also the eigenvectors of <strong class="markup--strong markup--p-strong">M</strong>, we can then write <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">x</em></strong> as a linear combination of these vectors in the basis of ℝⁿ,</p><figure name="370a" id="370a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hIRoTDh0cHXyVIPX4BTmeQ.png" data-width="1326" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*hIRoTDh0cHXyVIPX4BTmeQ.png"></figure><p name="ecee" id="ecee" class="graf graf--p graf-after--figure">Then,</p><figure name="8328" id="8328" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*uLheEvOEi_aqhKh-JB9qGw.png" data-width="1326" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*uLheEvOEi_aqhKh-JB9qGw.png"></figure><p name="5216" id="5216" class="graf graf--p graf-after--figure">then,</p><figure name="b16b" id="b16b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*sA60A1XweX11h4aSkpGIpQ.png" data-width="1326" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*sA60A1XweX11h4aSkpGIpQ.png"></figure><p name="7b8b" id="7b8b" class="graf graf--p graf-after--figure">then,</p><figure name="1bda" id="1bda" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*BMHZfsPPR9J5l0klrK7FNQ.png" data-width="1326" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*BMHZfsPPR9J5l0klrK7FNQ.png"></figure><p name="0d2e" id="0d2e" class="graf graf--p graf-after--figure">based on the property of the stochastic matrix <strong class="markup--strong markup--p-strong">M</strong>, we have,</p><figure name="8912" id="8912" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*xHgUtqMC0M17dyPP.png" data-width="1398" data-height="58" src="https://cdn-images-1.medium.com/max/800/0*xHgUtqMC0M17dyPP.png"></figure><p name="4f6a" id="4f6a" class="graf graf--p graf-after--figure">when,</p><figure name="62d7" id="62d7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JUgi4ly5ePpC1xDyC3K4tA.png" data-width="1326" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*JUgi4ly5ePpC1xDyC3K4tA.png"></figure><p name="116f" id="116f" class="graf graf--p graf-after--figure">thus,</p><figure name="592d" id="592d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*0XvUGLbSXROu-f5y.png" data-width="1398" data-height="66" src="https://cdn-images-1.medium.com/max/800/0*0XvUGLbSXROu-f5y.png"></figure><p name="db79" id="db79" class="graf graf--p graf-after--figure">then,</p><figure name="d02f" id="d02f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aLUtVYJm4Q4iQkyQcseRZQ.png" data-width="1326" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*aLUtVYJm4Q4iQkyQcseRZQ.png"></figure><p name="ebff" id="ebff" class="graf graf--p graf-after--figure">if we let,</p><figure name="81b5" id="81b5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*jSlPqLKUpKP3K-lRz5p0Pg.png" data-width="1326" data-height="60" src="https://cdn-images-1.medium.com/max/800/1*jSlPqLKUpKP3K-lRz5p0Pg.png"></figure><p name="97cc" id="97cc" class="graf graf--p graf-after--figure">for any given <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">x</em></strong>, we have <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong> as our stable state,</p><figure name="52b9" id="52b9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*0kFLfIWWRF1zmhfk-fRPkA.png" data-width="1326" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*0kFLfIWWRF1zmhfk-fRPkA.png"></figure><p name="7946" id="7946" class="graf graf--p graf-after--figure">Because the matrix multiplication is easier than solving equation systems, so we can compute the stable state of the random walking problem in this easier way.</p><p name="387f" id="387f" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">3. Google’s Pagerank Algorithm</strong></p><p name="39ff" id="39ff" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Why Ranking Webpages Problem is a Random Walking Problem?</strong></p><p name="33a0" id="33a0" class="graf graf--p graf-after--p">The concept of the internet is similar to a directed graph, with every IP address being treated as the nodes, and we can link different pages with hyperlinks.</p><p name="04be" id="04be" class="graf graf--p graf-after--p">The basic idea of PageRank is to rank the webpages based on the probability they pop up in the internet world. If a website has more sites directing to it, then it will have a higher probability to pop up on the internet. By this idea, we can calculate the stable state of the websites and rank them with these probabilities of the stable state.</p><p name="5874" id="5874" class="graf graf--p graf-after--p">Thus, based on the previous discussion, we have the stochastic matrix <strong class="markup--strong markup--p-strong">M</strong> of pagerank as,</p><figure name="9bb3" id="9bb3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ZX45H6NGOAqJ8U5houbHMw.png" data-width="1326" data-height="60" src="https://cdn-images-1.medium.com/max/800/1*ZX45H6NGOAqJ8U5houbHMw.png"></figure><p name="6ee7" id="6ee7" class="graf graf--p graf-after--figure">where <strong class="markup--strong markup--p-strong">A</strong> is the adjacent matrix of the graph <strong class="markup--strong markup--p-strong">G</strong> and <strong class="markup--strong markup--p-strong">D</strong> is the degree matrix of the graph <strong class="markup--strong markup--p-strong">G</strong>. However, this matrix still have some issues and we have to solve all of them.</p><p name="7967" id="7967" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(2) Zero Outer Degree Issue</strong></p><p name="084d" id="084d" class="graf graf--p graf-after--p">In the internet world, a node can have several edges pointing into it but no edges pointing out. Particularly in this example, the outer degree of this vertex equals zero and we can not construct a stochastic matrix <strong class="markup--strong markup--p-strong">M </strong>(because one column of <strong class="markup--strong markup--p-strong">M</strong> will be zeros).</p><p name="8a3f" id="8a3f" class="graf graf--p graf-after--p">One idea to solve this problem is to add a self-pointed edge that link back to this node. However, this idea is a misunderstanding because the random walking process will stuck in this loop forever.</p><p name="9e14" id="9e14" class="graf graf--p graf-after--p">Another idea is to jump randomly to any other nodes after this closed node. It is similar to add edges that point form the present node to all of the other nodes. Because this equals a random start from any of these node, so it actually didn’t change the relative rank of the stable state. Therefore, we can figure this problem out by exchanging the zeros in this column of A to a column of ones.</p><p name="7053" id="7053" class="graf graf--p graf-after--p">After this, we are glad to see that <strong class="markup--strong markup--p-strong">M</strong> is still a stochastic matrix.</p><figure name="49d7" id="49d7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*T-rDjxkoVIGnCfmMkDzQXg.png" data-width="1854" data-height="402" src="https://cdn-images-1.medium.com/max/800/1*T-rDjxkoVIGnCfmMkDzQXg.png"></figure><p name="43c0" id="43c0" class="graf graf--p graf-after--figure">Written by matrix, suppose we have a vector <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">e</em></strong> which is,</p><figure name="f7d6" id="f7d6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Y_nqVt3GtOd9mP_xqDPgKw.png" data-width="1438" data-height="184" src="https://cdn-images-1.medium.com/max/800/1*Y_nqVt3GtOd9mP_xqDPgKw.png"></figure><p name="d4ba" id="d4ba" class="graf graf--p graf-after--figure">also, we have a vector <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">a</em></strong> where,</p><figure name="0e00" id="0e00" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QbBovaY31stUsj7ftmX8yQ.png" data-width="1438" data-height="184" src="https://cdn-images-1.medium.com/max/800/1*QbBovaY31stUsj7ftmX8yQ.png"></figure><p name="4fa8" id="4fa8" class="graf graf--p graf-after--figure">Therefore, we can construct a matrix by them and then add it to the adjacent matrix A,</p><figure name="3070" id="3070" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*rWtkwhUWOQgxb4gYBI-o5A.png" data-width="1284" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*rWtkwhUWOQgxb4gYBI-o5A.png"></figure><p name="6840" id="6840" class="graf graf--p graf-after--figure">Therefore, the adjusted stochastic matrix <strong class="markup--strong markup--p-strong">H</strong> is,</p><figure name="ab80" id="ab80" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hCOLY4e-EogttCOsJC9-vw.png" data-width="1284" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*hCOLY4e-EogttCOsJC9-vw.png"></figure><p name="b07d" id="b07d" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) Disconnected Graph Issue (Subnetwork)</strong></p><p name="17d4" id="17d4" class="graf graf--p graf-after--p">The other issue is that we can have a disconnected graph that if we start from some part of the graph, we can never reach the other part of this graph.</p><p name="1d6e" id="1d6e" class="graf graf--p graf-after--p">One way to solve this problem is to add a <strong class="markup--strong markup--p-strong">teleportation matrix</strong> to the adjacent matrix so that on each of the vertex, we have a percentage to shift to another vertex. The teleportation matrix is a matrix with all entries equals one.</p><figure name="95e9" id="95e9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*e2fSGpUqEsJnzWXGNzVQwg.png" data-width="1850" data-height="340" src="https://cdn-images-1.medium.com/max/800/1*e2fSGpUqEsJnzWXGNzVQwg.png"></figure><p name="06ff" id="06ff" class="graf graf--p graf-after--figure">Because we still want <strong class="markup--strong markup--p-strong">M</strong> to be a stochastic matrix, so we have to normalize the result of <strong class="markup--strong markup--p-strong">M</strong> = <strong class="markup--strong markup--p-strong">H</strong> + <strong class="markup--strong markup--p-strong">T</strong>.</p><p name="b09e" id="b09e" class="graf graf--p graf-after--p">However, google chose another way to make this a stochastic matrix, they add a new parameter α in order to reduce the influence of the teleportation matrix. If we directly normalize this, we can have a high teleportation rate, although the result remains. In the area of computer science, it costs more for us to reach a stable state. Therefore, google adds a parameter α and then rewrite the stochastic matrix,</p><figure name="9ec4" id="9ec4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*BhZIBgroMYlEgYPdVdACMg.png" data-width="1284" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*BhZIBgroMYlEgYPdVdACMg.png"></figure><p name="3b6f" id="3b6f" class="graf graf--p graf-after--figure">In practice, α is chosen between 0.8 ~ 0.85 by google. Although it will not influence the final rank by changing the parameter α, it reduces the cost of calculating when α is chosen between 0.8 ~ 0.85 (we are not going to prove this).</p><p name="8c12" id="8c12" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(4) Calculating the PageRank</strong></p><p name="5e30" id="5e30" class="graf graf--p graf-after--p">We have already talked about the power method in the previous part, and then we utilize this method on the pagerank matrix M we have constructed, then,</p><figure name="6cac" id="6cac" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*0kFLfIWWRF1zmhfk-fRPkA.png" data-width="1326" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*0kFLfIWWRF1zmhfk-fRPkA.png"></figure><p name="345d" id="345d" class="graf graf--p graf-after--figure graf--trailing">Because <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong> is not normalized in this case, so if we want to have the real probability, we can do normalization on <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">p</em></strong>. But if our goal is to rank the webpages, then congratulations, you have already gotten the result! Now you’ve mastered the pagerank algorithm.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/27c5962901b3"><time class="dt-published" datetime="2020-09-21T06:41:37.532Z">September 21, 2020</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/linear-algebra-11-graph-theory-fundamentals-random-walk-problem-laplacian-matrix-and-pagerank-27c5962901b3" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>