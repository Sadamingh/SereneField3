<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Relational Database Lab 2 | CRUD and Select Operations Practice, Variables, Case, and Pivot…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Relational Database Lab 2 | CRUD and Select Operations Practice, Variables, Case, and Pivot…</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Relational Database
</section>
<section data-field="body" class="e-content">
<section name="b94c" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ce67" id="ce67" class="graf graf--h3 graf--leading graf--title">Relational Database Lab 2 | CRUD and Select Operations Practice, <strong class="markup--strong markup--h3-strong">Variables, Case, and Pivot Statement</strong></h3><figure name="725d" id="725d" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*3IaCF_vbefdstmWFpZxCRw.png" data-width="1600" data-height="1200" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*3IaCF_vbefdstmWFpZxCRw.png"></figure><p name="e2ec" id="e2ec" class="graf graf--p graf-after--figure">Some of the practice problems are from <a href="https://www.hackerrank.com/" data-href="https://www.hackerrank.com/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://www.hackerrank.com/</a>.</p><p name="ffae" id="ffae" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">1. CRUD Operations</strong></p><p name="be9e" id="be9e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Create a Database</strong></p><p name="f905" id="f905" class="graf graf--p graf-after--p">Create a database named <strong class="markup--strong markup--p-strong">PRACTICE</strong>.</p><figure name="b485" id="b485" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/9486a37e3b6eab1bc73a79d32228268d.js"></script></figure><p name="4402" id="4402" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) CREATE Table</strong></p><p name="b936" id="b936" class="graf graf--p graf-after--p">Create a table named CITY and the <strong class="markup--strong markup--p-strong">CITY</strong> table is described as follows:</p><figure name="c587" id="c587" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Za-JBQaDhwuTifxTuFc5lA.png" data-width="1182" data-height="348" src="https://cdn-images-1.medium.com/max/800/1*Za-JBQaDhwuTifxTuFc5lA.png"></figure><p name="722e" id="722e" class="graf graf--p graf-after--figure">Note that all the values in this table are NOT NULL.</p><figure name="94b0" id="94b0" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/80c90ad0fc6d42fcbd31e03aa9de96c6.js"></script></figure><p name="7013" id="7013" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) INSERT Values</strong></p><p name="3e95" id="3e95" class="graf graf--p graf-after--p">Add the following data to the <strong class="markup--strong markup--p-strong">CITY</strong> table:</p><pre name="5410" id="5410" class="graf graf--pre graf-after--p">6 Rotterdam NLD Zuid-Holland 593321<br>3878 Scottsdale USA Arizona 202705<br>3965 Corona USA California 124966<br>3973 Concord USA California 121780<br>3977 Cedar Rapids USA Iowa 120758<br>3982 Coral Springs USA Florida 117549<br>4054 Fairfield USA California 92256<br>4058 Boulder USA Colorado 91238<br>4061 Fall River USA Massachusetts 90555</pre><figure name="87bb" id="87bb" class="graf graf--figure graf--iframe graf-after--pre"><script src="https://gist.github.com/Sadamingh/0cd178d8940b0d1c6e0404ca61bb6d34.js"></script></figure><p name="3406" id="3406" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) UPDATE the Population in Rotterdam</strong></p><p name="5360" id="5360" class="graf graf--p graf-after--p">There is a change in the population in Rotterdam to 582571, update this value in the <strong class="markup--strong markup--p-strong">CITY</strong> table.</p><figure name="fc02" id="fc02" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/953446ba90deb7d97e3c2b3d36a6dd90.js"></script></figure><p name="900a" id="900a" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(5) DELETE the City of Rotterdam</strong></p><p name="67d4" id="67d4" class="graf graf--p graf-after--p">Delete the city named Rotterdam in the <strong class="markup--strong markup--p-strong">CITY </strong>table.</p><figure name="664b" id="664b" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/96f6b36d83df55698c1ef4d988a3b820.js"></script></figure><p name="3244" id="3244" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(6) SELECT the result</strong></p><p name="8f07" id="8f07" class="graf graf--p graf-after--p">Output the content of the <strong class="markup--strong markup--p-strong">CITY</strong> table.</p><figure name="8497" id="8497" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/f614d4ba889a40305518bc0f9fdcf08e.js"></script></figure><p name="eb49" id="eb49" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. SELECT Operation</strong></p><p name="1312" id="1312" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Practice #1</strong></p><p name="f648" id="f648" class="graf graf--p graf-after--p">Query all columns for all American cities in the <strong class="markup--strong markup--p-strong">CITY</strong> table with populations larger than <code class="markup--code markup--p-code">100000</code>. The <strong class="markup--strong markup--p-strong">CountryCode</strong> for America is <code class="markup--code markup--p-code">USA</code>. The <strong class="markup--strong markup--p-strong">CITY</strong> table is described as follows (Note that the values in this table are <strong class="markup--strong markup--p-strong">not the same as </strong>what we have put inside above):</p><figure name="03b8" id="03b8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Za-JBQaDhwuTifxTuFc5lA.png" data-width="1182" data-height="348" src="https://cdn-images-1.medium.com/max/800/1*Za-JBQaDhwuTifxTuFc5lA.png"></figure><figure name="e423" id="e423" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/Sadamingh/b930db56e8536e16676e6584971c8626.js"></script></figure><p name="3ebf" id="3ebf" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) Practice #2</strong></p><p name="c185" id="c185" class="graf graf--p graf-after--p">For the same table of practice #1, query all columns (attributes) for every row in the <strong class="markup--strong markup--p-strong">CITY</strong> table.</p><figure name="ac4d" id="ac4d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/96d4027e420cf078e1f5b1d0ff1d0a97.js"></script></figure><p name="22fc" id="22fc" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) Practice #3</strong></p><p name="4fe1" id="4fe1" class="graf graf--p graf-after--p">For the same table of practice #1, query all columns for a city in <strong class="markup--strong markup--p-strong">CITY</strong> with the ID <code class="markup--code markup--p-code">1661</code>.</p><figure name="9cea" id="9cea" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/415ed8498d3392b0608279e2e2d0a2fc.js"></script></figure><p name="c3d1" id="c3d1" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) Practice #4</strong></p><p name="57c1" id="57c1" class="graf graf--p graf-after--p">For the same table of practice #1, query all attributes of every Japanese city in the <strong class="markup--strong markup--p-strong">CITY</strong> table. The <strong class="markup--strong markup--p-strong">COUNTRYCODE</strong> for Japan is <code class="markup--code markup--p-code">JPN</code>.</p><figure name="4d57" id="4d57" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/d1353fc5da9bfe76ef78fdc29f23224b.js"></script></figure><p name="4fef" id="4fef" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(5) Practice #5</strong></p><p name="d8f8" id="d8f8" class="graf graf--p graf-after--p">For the same table of practice #1, query the names of all the Japanese cities in the <strong class="markup--strong markup--p-strong">CITY</strong> table. The <strong class="markup--strong markup--p-strong">COUNTRYCODE</strong> for Japan is <code class="markup--code markup--p-code">JPN</code>.</p><figure name="2d8a" id="2d8a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/94842e2852d083834b20ba6277f0edde.js"></script></figure><p name="fa2d" id="fa2d" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(6) Practice #6</strong></p><p name="62f6" id="62f6" class="graf graf--p graf-after--p">Query a list of <strong class="markup--strong markup--p-strong">CITY</strong> and <strong class="markup--strong markup--p-strong">STATE</strong> from the <strong class="markup--strong markup--p-strong">STATION</strong> table. The <strong class="markup--strong markup--p-strong">STATION</strong> table is described as follows where <strong class="markup--strong markup--p-strong">LAT_N</strong> is the northern latitude and <strong class="markup--strong markup--p-strong">LONG_W</strong> is the western longitude.</p><figure name="974a" id="974a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EMo6mzUnXNpcuolup4yHtg.png" data-width="1098" data-height="316" src="https://cdn-images-1.medium.com/max/800/1*EMo6mzUnXNpcuolup4yHtg.png"></figure><figure name="00ef" id="00ef" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/Sadamingh/f192a1544b135fcbcfd5723027458bb7.js"></script></figure><p name="e8a7" id="e8a7" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(7) Practice #7</strong></p><p name="166d" id="166d" class="graf graf--p graf-after--p">For the same table of practice #6, query a list of <strong class="markup--strong markup--p-strong">CITY</strong> names from <strong class="markup--strong markup--p-strong">STATION</strong> for cities that have an even <strong class="markup--strong markup--p-strong">ID</strong> number. Print the results in any order, but exclude duplicates from the answer.</p><figure name="1a2b" id="1a2b" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/af882c71b562d89573247edb1327de15.js"></script></figure><p name="d6f3" id="d6f3" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(8) Practice #8</strong></p><p name="b478" id="b478" class="graf graf--p graf-after--p">For the same table of practice #6, find the difference between the total number of <strong class="markup--strong markup--p-strong">CITY</strong> entries in the table and the number of distinct <strong class="markup--strong markup--p-strong">CITY</strong> entries in the table.</p><p name="506d" id="506d" class="graf graf--p graf-after--p">For example, if there are three records in the table with <strong class="markup--strong markup--p-strong">CITY</strong> values ‘New York’, ‘New York’, ‘Bengaluru’, there are 2 different city names: ‘New York’ and ‘Bengaluru’. The query returns 1.</p><figure name="b6e5" id="b6e5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/e6ef7a00de692998deac45c3463cfee2.js"></script></figure><p name="a703" id="a703" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(9) Practice #9</strong></p><p name="3043" id="3043" class="graf graf--p graf-after--p">For the same table of practice #6, query the two cities in <strong class="markup--strong markup--p-strong">STATION</strong> with the shortest and longest CITY names, as well as their respective lengths (i.e.: number of characters in the name). If there is more than one smallest or largest city, choose the one that comes first when ordered alphabetically.</p><p name="dfdb" id="dfdb" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Sample Input</strong></p><p name="6c40" id="6c40" class="graf graf--p graf-after--p">For example, <strong class="markup--strong markup--p-strong">CITY</strong> has four entries: <strong class="markup--strong markup--p-strong">DEF, ABC, PQRS,</strong> and <strong class="markup--strong markup--p-strong">WXY</strong>.</p><p name="b172" id="b172" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Sample Output</strong></p><pre name="4f9d" id="4f9d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">ABC 3<br>PQRS 4</code></pre><figure name="4100" id="4100" class="graf graf--figure graf--iframe graf-after--pre"><script src="https://gist.github.com/Sadamingh/9abc3d017e8eb46d957a70beeae78223.js"></script></figure><p name="b19a" id="b19a" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(10) Practice #10</strong></p><p name="352a" id="352a" class="graf graf--p graf-after--p">For the same table of practice #6, query the list of CITY names starting with vowels (i.e., <code class="markup--code markup--p-code">a</code>, <code class="markup--code markup--p-code">e</code>, <code class="markup--code markup--p-code">i</code>, <code class="markup--code markup--p-code">o</code>, or <code class="markup--code markup--p-code">u</code>) from <strong class="markup--strong markup--p-strong">STATION</strong>. Your result cannot contain duplicates.</p><figure name="fac1" id="fac1" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/d1d7d345c44b83c98b3373efffaaa69d.js"></script></figure><p name="16bf" id="16bf" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(11) Practice #11</strong></p><p name="85eb" id="85eb" class="graf graf--p graf-after--p">For the same table of practice #6, query the list of CITY names ending with vowels (a, e, i, o, u) from <strong class="markup--strong markup--p-strong">STATION</strong>. Your result cannot contain duplicates.</p><figure name="9f43" id="9f43" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/8de6d8b592e065814cad152bdc2f8b31.js"></script></figure><p name="bc8e" id="bc8e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(12) Practice #12</strong></p><p name="76f9" id="76f9" class="graf graf--p graf-after--p">For the same table of practice #6, query the list of CITY names from <strong class="markup--strong markup--p-strong">STATION</strong> which have vowels (i.e., a, e, i, o, and u) as both their first and last characters. Your result cannot contain duplicates.</p><figure name="3a86" id="3a86" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/0a78d16344ffc843420f3d100573f608.js"></script></figure><p name="1fc9" id="1fc9" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(13) Practice #13</strong></p><p name="87a2" id="87a2" class="graf graf--p graf-after--p">For the same table of practice #6, query the list of CITY names from <strong class="markup--strong markup--p-strong">STATION</strong> that do not start with vowels. Your result cannot contain duplicates.</p><figure name="2cab" id="2cab" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/6efbea76184b20e03dc851a74ca295da.js"></script></figure><p name="fb3e" id="fb3e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(14) Practice #14</strong></p><p name="b861" id="b861" class="graf graf--p graf-after--p">For the same table of practice #6, query the list of CITY names from <strong class="markup--strong markup--p-strong">STATION</strong> that either does not start with vowels or do not end with vowels. Your result cannot contain duplicates.</p><figure name="73e3" id="73e3" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/2208da09339f5035fa591e1cbcaf1b51.js"></script></figure><p name="77c9" id="77c9" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(15) Practice #15</strong></p><p name="2a65" id="2a65" class="graf graf--p graf-after--p">Query the Name of any student in <strong class="markup--strong markup--p-strong">STUDENTS</strong> who scored higher than 75 Marks. Order your output by the last three characters of each name. If two or more students both have names ending in the same last three characters (i.e.: Bobby, Robby, etc.), secondary sort them by ascending ID. The <strong class="markup--strong markup--p-strong">STUDENTS</strong> table is described as follows and The Name column only contains uppercase (<code class="markup--code markup--p-code">A</code>-<code class="markup--code markup--p-code">Z</code>) and lowercase (<code class="markup--code markup--p-code">a</code>-<code class="markup--code markup--p-code">z</code>) letters.</p><figure name="c3ad" id="c3ad" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*l51y1nxTY1EHbaalQ4vMYQ.png" data-width="1662" data-height="364" src="https://cdn-images-1.medium.com/max/800/1*l51y1nxTY1EHbaalQ4vMYQ.png"></figure><figure name="9e12" id="9e12" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/Sadamingh/cb5efade8fbd290ef782f2d052fe2322.js"></script></figure><p name="210f" id="210f" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(16) Practice #16</strong></p><p name="62cd" id="62cd" class="graf graf--p graf-after--p">Write a query that prints a list of employee names (i.e.: the name attribute) from the <strong class="markup--strong markup--p-strong">Employee</strong> table in alphabetical order. The <strong class="markup--strong markup--p-strong">Employee</strong> table containing employee data for a company is described as follows:</p><figure name="bbe0" id="bbe0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TbzefYZcA5rlY7w4X9-aww.png" data-width="1662" data-height="378" src="https://cdn-images-1.medium.com/max/800/1*TbzefYZcA5rlY7w4X9-aww.png"></figure><p name="499b" id="499b" class="graf graf--p graf-after--figure">where employee_id is an employee’s ID number, name is their name, months is the total number of months they’ve been working for the company, and salary is their monthly salary.</p><figure name="96a5" id="96a5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/ef68a06043030aed8ae9153e361a11ff.js"></script></figure><p name="90e0" id="90e0" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(17) Practice #17</strong></p><p name="48cf" id="48cf" class="graf graf--p graf-after--p">For the same table of practice #16, write a query that prints a list of employee names (i.e.: the name attribute) for employees in <strong class="markup--strong markup--p-strong">Employee</strong> having a salary greater than $2000 per month who have been employees for less than 10 months. Sort your result by ascending employee_id.</p><figure name="bae2" id="bae2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/c33071af3fea1c4072c838fde7bf03c0.js"></script></figure><p name="1f06" id="1f06" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(18) Practice #18</strong></p><p name="2d01" id="2d01" class="graf graf--p graf-after--p">For the same table of practice #1, query the total population of all cities in <strong class="markup--strong markup--p-strong">CITY</strong> where District is <strong class="markup--strong markup--p-strong">California</strong>.</p><figure name="6071" id="6071" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/6e9a99dd3536e9095fc24b919419f9e5.js"></script></figure><p name="c909" id="c909" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(19) Practice #19</strong></p><p name="a784" id="a784" class="graf graf--p graf-after--p">For the same table of practice #1, query the average population of all cities in <strong class="markup--strong markup--p-strong">CITY</strong> where District is <strong class="markup--strong markup--p-strong">California</strong>.</p><figure name="cb62" id="cb62" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/4bc7772b454ba7acc777129fb6f92cdb.js"></script></figure><p name="7260" id="7260" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(20) Practice #20</strong></p><p name="1fcc" id="1fcc" class="graf graf--p graf-after--p">For the same table of practice #1, query the average population for all cities in <strong class="markup--strong markup--p-strong">CITY</strong>, rounded down to the nearest integer.</p><figure name="9e74" id="9e74" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/0be97e86e3ee3a6a1df972fd0751a18f.js"></script></figure><p name="4f2e" id="4f2e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(21) Practice #21</strong></p><p name="0378" id="0378" class="graf graf--p graf-after--p">For the same table of practice #1, query the difference between the maximum and minimum populations in <strong class="markup--strong markup--p-strong">CITY</strong>.</p><figure name="0ce5" id="0ce5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/3bde5f6c355b3efc2d5073cbdab8cea0.js"></script></figure><p name="27f5" id="27f5" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(22) Practice #22</strong></p><p name="b6ff" id="b6ff" class="graf graf--p graf-after--p">Query an alphabetically ordered list of all names in <strong class="markup--strong markup--p-strong">OCCUPATIONS</strong>, immediately followed by the first letter of each profession as a parenthetical (i.e.: enclosed in parentheses). For example: <code class="markup--code markup--p-code">AnActorName(A)</code>, <code class="markup--code markup--p-code">ADoctorName(D)</code>, <code class="markup--code markup--p-code">AProfessorName(P)</code>, and <code class="markup--code markup--p-code">ASingerName(S)</code>.</p><p name="15f4" id="15f4" class="graf graf--p graf-after--p">There will be at least two entries in the table for each type of occupation. The <strong class="markup--strong markup--p-strong">OCCUPATIONS</strong> table is described as follows and occupation will only contain one of the following values: <strong class="markup--strong markup--p-strong">Doctor</strong>, <strong class="markup--strong markup--p-strong">Professor</strong>, <strong class="markup--strong markup--p-strong">Singer,</strong> or <strong class="markup--strong markup--p-strong">Actor</strong>.</p><figure name="b145" id="b145" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*7BblPPHG-y5_wyxC.png" data-width="313" data-height="139" src="https://cdn-images-1.medium.com/max/800/0*7BblPPHG-y5_wyxC.png"></figure><figure name="1dfb" id="1dfb" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/Sadamingh/e981d64972a44d1087a713e46acaf036.js"></script></figure><p name="981f" id="981f" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(23) Practice #23</strong></p><p name="5f51" id="5f51" class="graf graf--p graf-after--p">For the same table of practice #22, query the number of occurrences of each occupation in <strong class="markup--strong markup--p-strong">OCCUPATIONS</strong>. Sort the occurrences in ascending order, and output them in the following format:</p><pre name="d7e5" id="d7e5" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">There are a total of [occupation_count] [occupation]s.</code></pre><p name="7fb9" id="7fb9" class="graf graf--p graf-after--pre">where <code class="markup--code markup--p-code">[occupation_count]</code> is the number of occurrences of occupation in <strong class="markup--strong markup--p-strong">OCCUPATIONS</strong> and <code class="markup--code markup--p-code">[occupation]</code> is the lowercase occupation name. If more than one Occupation has the same <code class="markup--code markup--p-code">[occupation_count]</code>, they should be ordered alphabetically.</p><figure name="8402" id="8402" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/7e58b1fb63c9a69a036a9bad6b0da6ed.js"></script></figure><p name="da80" id="da80" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. Variables, Case, and Pivot Statement</strong></p><p name="9941" id="9941" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Practice #24</strong></p><p name="c372" id="c372" class="graf graf--p graf-after--p">Set the variables myName and myNum, and then print &lt;myName&gt; is &lt;myNum&gt; years old.</p><figure name="d92f" id="d92f" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/9bf6bc05be551b6233ef45ff3060906a.js"></script></figure><p name="bb3f" id="bb3f" class="graf graf--p graf-after--figure">However, this is a SQL Server feature, and if we want to use variables in PostgreSql, we have to use the WITH operation,</p><figure name="30ff" id="30ff" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/ba57f6d50a47d30e6a0ae3c444810cfd.js"></script></figure><p name="54d4" id="54d4" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) Practice #25</strong></p><p name="a2b6" id="a2b6" class="graf graf--p graf-after--p">For the same table of practice #1, query a new column called citysize and when the population is larger than 150000, give an ‘L’ to this column, else if the population is between 100000 to 150000, give an ‘M’ to this column, and for the rest of the values, give an ‘S’.</p><figure name="f605" id="f605" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/77e0025e3c1dc9cff51743f594f7114d.js"></script></figure><p name="52d1" id="52d1" class="graf graf--p graf-after--figure">We can also include the names of cities in the output,</p><figure name="7b19" id="7b19" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/adebce465782ebb62e28bb3ac17cea57.js"></script></figure><p name="c1ae" id="c1ae" class="graf graf--p graf-after--figure">We can make the output a new table named <strong class="markup--strong markup--p-strong">CITYSIZE</strong>,</p><figure name="df7d" id="df7d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/ba24d197976f218f3f30d760323c0d81.js"></script></figure><p name="a17c" id="a17c" class="graf graf--p graf-after--figure">Also, set the NAME column as our primary key,</p><figure name="1fd0" id="1fd0" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/241460bea03b951742b360e24a517e9c.js"></script></figure><p name="c6b5" id="c6b5" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) Practice #26</strong></p><p name="ac9c" id="ac9c" class="graf graf--p graf-after--p">For the same table of practice #1, pivot the POPULATION column in <strong class="markup--strong markup--p-strong">CITY</strong> so that we can have a sum of the population in each district. We are assuming that you are probably using PostgreSQL and here’s an example to create this pivot,</p><figure name="bdf7" id="bdf7" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/9b35085f1c2303ed9a41371f79ed050f.js"></script></figure><p name="a6af" id="a6af" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) Practice #27</strong></p><p name="76f6" id="76f6" class="graf graf--p graf-after--p">For the same table of practice #1, pivot the POPULATION column in <strong class="markup--strong markup--p-strong">CITY</strong> so that we can have a sum of the population in each district <strong class="markup--strong markup--p-strong">by countries</strong>. We are assuming that you are probably using PostgreSQL and here’s an example to create this pivot,</p><figure name="271f" id="271f" class="graf graf--figure graf--iframe graf-after--p graf--trailing"><script src="https://gist.github.com/Sadamingh/add1c5e0fa5cfab8591880819266876f.js"></script></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/9e6974d4ad7e"><time class="dt-published" datetime="2020-10-21T12:03:11.243Z">October 21, 2020</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/relational-database-lab-2-crud-and-select-operations-practice-variables-case-and-pivot-9e6974d4ad7e" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>