<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Relational Database 4 | JOIN Operation, Conditional Expressions, Nested Queries, and Aggregate…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Relational Database 4 | JOIN Operation, Conditional Expressions, Nested Queries, and Aggregate…</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Relational Database
</section>
<section data-field="body" class="e-content">
<section name="e64f" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="e9b8" id="e9b8" class="graf graf--h3 graf--leading graf--title">Relational Database 4 | <strong class="markup--strong markup--h3-strong">JOIN Operation, Conditional Expressions, Nested Queries, and Aggregate Operators</strong></h3><figure name="0c3f" id="0c3f" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*3IaCF_vbefdstmWFpZxCRw.png" data-width="1600" data-height="1200" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*3IaCF_vbefdstmWFpZxCRw.png"></figure><ol class="postList"><li name="96d1" id="96d1" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">JOIN Operation</strong></li></ol><p name="c8a2" id="c8a2" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(0) Basic Setup</strong></p><p name="141d" id="141d" class="graf graf--p graf-after--p">Suppose we have two following tables,</p><figure name="73e4" id="73e4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Ch1F7tlStkS463EsHrfc1Q.png" data-width="1760" data-height="416" src="https://cdn-images-1.medium.com/max/800/1*Ch1F7tlStkS463EsHrfc1Q.png"></figure><p name="cf66" id="cf66" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(1) CROSS JOIN</strong></p><p name="5741" id="5741" class="graf graf--p graf-after--p">Returns a cartesian product between two sets of data.</p><pre name="4291" id="4291" class="graf graf--pre graf-after--p">SELECT *<br>FROM &lt;table1&gt;<br>CROSS JOIN &lt;table2&gt;;</pre><figure name="a35a" id="a35a" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*QJrF79MvmaG49zmqRzetVg.png" data-width="1760" data-height="1316" src="https://cdn-images-1.medium.com/max/800/1*QJrF79MvmaG49zmqRzetVg.png"></figure><p name="3e14" id="3e14" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) INNER JOIN</strong></p><p name="7d2b" id="7d2b" class="graf graf--p graf-after--p">Returns rows appearing in both tables.</p><pre name="b81b" id="b81b" class="graf graf--pre graf-after--p">SELECT *<br>FROM &lt;table1&gt;<br>INNER JOIN &lt;table2&gt;<br>ON &lt;table1&gt;.&lt;colname1&gt;=&lt;table2&gt;.&lt;colname2&gt;;</pre><p name="87f5" id="87f5" class="graf graf--p graf-after--pre">With table1.sid = table2.sid,</p><figure name="9153" id="9153" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*34UTu7hQjMq8YVP-ADXfuA.png" data-width="1894" data-height="824" src="https://cdn-images-1.medium.com/max/800/1*34UTu7hQjMq8YVP-ADXfuA.png"></figure><p name="fd53" id="fd53" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) LEFT JOIN</strong></p><p name="59ca" id="59ca" class="graf graf--p graf-after--p">Return all rows from the left table, and the matched rows from the right table.</p><pre name="6249" id="6249" class="graf graf--pre graf-after--p">SELECT *<br>FROM &lt;table1&gt;<br>LEFT JOIN &lt;table2&gt;<br>ON &lt;table1&gt;.&lt;colname1&gt;=&lt;table2&gt;.&lt;colname2&gt;;</pre><figure name="4233" id="4233" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*gLpZk5wFDZejSwsgXSTOYg.png" data-width="1894" data-height="824" src="https://cdn-images-1.medium.com/max/800/1*gLpZk5wFDZejSwsgXSTOYg.png"></figure><p name="19f1" id="19f1" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) RIGHT JOIN</strong></p><p name="6c5d" id="6c5d" class="graf graf--p graf-after--p">Return all rows from the right table, and the matched rows from the left table.</p><pre name="0803" id="0803" class="graf graf--pre graf-after--p">SELECT *<br>FROM &lt;table1&gt;<br>RIGHT JOIN &lt;table2&gt;<br>ON &lt;table1&gt;.&lt;colname1&gt;=&lt;table2&gt;.&lt;colname2&gt;;</pre><figure name="913f" id="913f" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*93qsGos0MVZpmSUCA31NAQ.png" data-width="1894" data-height="824" src="https://cdn-images-1.medium.com/max/800/1*93qsGos0MVZpmSUCA31NAQ.png"></figure><p name="dbd0" id="dbd0" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(5) FULL JOIN</strong></p><p name="0c75" id="0c75" class="graf graf--p graf-after--p">Return all rows appearing in any of the tables.</p><pre name="bfaa" id="bfaa" class="graf graf--pre graf-after--p">SELECT *<br>FROM &lt;table1&gt;<br>FULL JOIN &lt;table2&gt;<br>ON &lt;table1&gt;.&lt;colname1&gt;=&lt;table2&gt;.&lt;colname2&gt;;</pre><figure name="0eca" id="0eca" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*4yLsc85jmYGxQbPSF62c2w.png" data-width="1894" data-height="824" src="https://cdn-images-1.medium.com/max/800/1*4yLsc85jmYGxQbPSF62c2w.png"></figure><p name="06a1" id="06a1" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. Conditional Expressions</strong></p><p name="cc10" id="cc10" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Basic Syntax</strong></p><pre name="b46a" id="b46a" class="graf graf--pre graf-after--p">CASE WHEN &lt;condition1&gt; THEN &lt;result1&gt;<br>     WHEN &lt;condition2&gt; THEN &lt;result2&gt;<br>     ...<br>     ELSE &lt;result&gt;<br>END</pre><p name="8f3b" id="8f3b" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">(2) Useful Functions</strong></p><ul class="postList"><li name="ce2b" id="ce2b" class="graf graf--li graf-after--p">Return the first not NULL value, else return NULL</li></ul><pre name="c8ad" id="c8ad" class="graf graf--pre graf-after--li">COALESCE(&lt;colname1&gt;, &lt;colname2&gt;, ...)</pre><ul class="postList"><li name="6e2a" id="6e2a" class="graf graf--li graf-after--pre">Return the NULL if value1 = value2, else return 1</li></ul><pre name="1de1" id="1de1" class="graf graf--pre graf-after--li">NULLIF(&lt;colname1&gt;, &lt;colname2&gt;)</pre><ul class="postList"><li name="1cc1" id="1cc1" class="graf graf--li graf-after--pre">Return the largest value (Ignore NULL value)</li></ul><pre name="8a9b" id="8a9b" class="graf graf--pre graf-after--li">GREATEST(&lt;colname1&gt;, &lt;colname2&gt;, ...)</pre><ul class="postList"><li name="30d9" id="30d9" class="graf graf--li graf-after--pre">Return the smallest value (Ignore NULL value)</li></ul><pre name="6610" id="6610" class="graf graf--pre graf-after--li">LEAST(&lt;colname1&gt;, &lt;colname2&gt;, ...)</pre><p name="a01f" id="a01f" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">3. Nested Queries</strong></p><p name="1535" id="1535" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Create a Subquery</strong></p><p name="27e2" id="27e2" class="graf graf--p graf-after--p">The syntax of a subquery is,</p><pre name="55ce" id="55ce" class="graf graf--pre graf-after--p">SELECT *<br>FROM (SELECT *  <br>      FROM &lt;table&gt;<br>      WHERE &lt;balabala&gt;<br>) AS &lt;new_tablename&gt;<br>WHERE &lt;balabala&gt;;</pre><p name="42f1" id="42f1" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">(2) Subquery Expressions</strong></p><ul class="postList"><li name="1eb6" id="1eb6" class="graf graf--li graf-after--p">EXISTS: check rows, if returns at least one row, then true</li></ul><pre name="90cc" id="90cc" class="graf graf--pre graf-after--li">SELECT *<br>FROM &lt;table&gt;<br>WHERE EXISTS (SELECT *<br>              FROM &lt;table1&gt;<br>              WHERE &lt;balabala&gt;<br>);</pre><ul class="postList"><li name="51f2" id="51f2" class="graf graf--li graf-after--pre">IN: check columns, if returns at least one row, then true</li></ul><pre name="3b4b" id="3b4b" class="graf graf--pre graf-after--li">SELECT *<br>FROM &lt;table&gt;<br>WHERE &lt;colname&gt; <br>IN (SELECT &lt;colname&gt;<br>    FROM &lt;table1&gt;<br>    WHERE &lt;balabala&gt;<br>);</pre><ul class="postList"><li name="4ced" id="4ced" class="graf graf--li graf-after--pre">ANY: check any conditions, if returns at least one row, then true</li></ul><pre name="7eb4" id="7eb4" class="graf graf--pre graf-after--li">SELECT *<br>FROM &lt;table&gt;<br>WHERE &lt;colname&gt; &lt;=<br>ANY (SELECT &lt;colname&gt;<br>     FROM &lt;table1&gt;<br>     WHERE &lt;balabala&gt;<br>);</pre><ul class="postList"><li name="503f" id="503f" class="graf graf--li graf-after--pre">ALL: check all conditions, if the condition holds for all rows, then true</li></ul><pre name="e797" id="e797" class="graf graf--pre graf-after--li">SELECT *<br>FROM &lt;table&gt;<br>WHERE &lt;colname&gt; &lt;=<br>ALL (SELECT &lt;colname&gt;<br>     FROM &lt;table1&gt;<br>     WHERE &lt;balabala&gt;<br>);</pre><ul class="postList"><li name="bbdd" id="bbdd" class="graf graf--li graf-after--pre">EXCEPT: reduce some items in another table</li></ul><pre name="2cc1" id="2cc1" class="graf graf--pre graf-after--li">SELECT *<br>FROM &lt;table&gt;<br>EXCEPT<br>SELECT *<br>FROM &lt;table1&gt;<br>WHERE &lt;balabala&gt;;</pre><p name="ec80" id="ec80" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">4. Aggregate Operators</strong></p><ul class="postList"><li name="b3a0" id="b3a0" class="graf graf--li graf-after--p">GROUP BY: group by a certain column with a math operation (AVG / MIN / MAX / ABS / etc.)</li></ul><pre name="9119" id="9119" class="graf graf--pre graf-after--li">GROUP BY &lt;colname&gt;</pre><ul class="postList"><li name="6194" id="6194" class="graf graf--li graf-after--pre">HAVING: gives the condition of a group</li></ul><p name="7e8e" id="7e8e" class="graf graf--p graf-after--li">For example, to make a group larger than 2 items,</p><pre name="fcc1" id="fcc1" class="graf graf--pre graf-after--p">HAVING COUNT(*) &gt;= 2</pre><p name="cafe" id="cafe" class="graf graf--p graf-after--pre">Here’s an <strong class="markup--strong markup--p-strong">example </strong>of why HAVING is good syntax. For Leetcode #569, the question is:</p><p name="1b5c" id="1b5c" class="graf graf--p graf-after--p">There is a table <code class="markup--code markup--p-code">courses</code> with columns: <strong class="markup--strong markup--p-strong">student</strong> and <strong class="markup--strong markup--p-strong">class. </strong>Please list out all classes which have more than or equal to 5 students. For example, the table:</p><pre name="1903" id="1903" class="graf graf--pre graf-after--p">+---------+------------+<br>| student | class      |<br>+---------+------------+<br>| A       | Math       |<br>| B       | English    |<br>| C       | Math       |<br>| D       | Biology    |<br>| E       | Math       |<br>| F       | Computer   |<br>| G       | Math       |<br>| H       | Math       |<br>| I       | Math       |<br>+---------+------------+</pre><p name="5580" id="5580" class="graf graf--p graf-after--pre">Should output:</p><pre name="5482" id="5482" class="graf graf--pre graf-after--p">+---------+<br>| class   |<br>+---------+<br>| Math    |<br>+---------+</pre><p name="c43e" id="c43e" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Note:</strong><br>The students should not be counted duplicate in each course.</p><p name="78c3" id="78c3" class="graf graf--p graf-after--p">If we are not using HAVING, we are going to write the following code,</p><pre name="c28e" id="c28e" class="graf graf--pre graf-after--p">SELECT class<br>FROM<br>(<br>    SELECT class, COUNT(DISTINCT student) AS num<br>    FROM courses<br>    GROUP BY class<br>) AS studentsnumber<br>WHERE num &gt;= 5;</pre><p name="57da" id="57da" class="graf graf--p graf-after--pre">If we use HAVING for our code, then,</p><pre name="a6f3" id="a6f3" class="graf graf--pre graf-after--p graf--trailing">SELECT class<br>FROM courses<br>GROUP BY class<br>HAVING COUNT(DISTINCT student) &gt;= 5;</pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/a580776f37e5"><time class="dt-published" datetime="2020-10-29T08:35:12.142Z">October 29, 2020</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/relational-database-4-join-operation-conditional-expressions-nested-queries-and-aggregate-a580776f37e5" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>