<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>High-Performance Computer Architecture 5 | Set Up the Virtual Machine and Simulator, Report…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">High-Performance Computer Architecture 5 | Set Up the Virtual Machine and Simulator, Report…</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: High-Performance Computer Architecture
</section>
<section data-field="body" class="e-content">
<section name="7e41" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5c60" id="5c60" class="graf graf--h3 graf--leading graf--title">High-Performance Computer Architecture 5 | <strong class="markup--strong markup--h3-strong">Set Up the Virtual Machine and Simulator, and Report Interpretation</strong></h3><figure name="0124" id="0124" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="0*sonfOc7oInkm0vkm.png" data-width="1446" data-height="864" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*sonfOc7oInkm0vkm.png"></figure><ol class="postList"><li name="81f6" id="81f6" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">Set Up the Virtual Machine</strong></li></ol><p name="1037" id="1037" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(1) VirtualBox Installation</strong></p><p name="5e8b" id="5e8b" class="graf graf--p graf-after--p">In this section, we would like to set up the experiment environment by the virtual machine. To continue, let’s download and install the <a href="https://www.virtualbox.org/wiki/Downloads" data-href="https://www.virtualbox.org/wiki/Downloads" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Oracle VM VirtualBox 6.1</a> (if there’s a new version, download the new one) from this <a href="https://download.virtualbox.org/virtualbox/6.1.16/VirtualBox-6.1.16-140961-OSX.dmg" data-href="https://download.virtualbox.org/virtualbox/6.1.16/VirtualBox-6.1.16-140961-OSX.dmg" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">link</a> (for Mac OS). Then, this should be installed as the VirtualBox application.</p><figure name="1baa" id="1baa" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UhkZnTCFJw3xdwhpTJQpmw.png" data-width="1690" data-height="226" src="https://cdn-images-1.medium.com/max/800/1*UhkZnTCFJw3xdwhpTJQpmw.png"></figure><p name="0956" id="0956" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) Download the Virtual Machine</strong></p><p name="b7f7" id="b7f7" class="graf graf--p graf-after--p">A virtual machine is an emulation of a computer system and we can import machines by the OVA file. First, let’s download the project virtual machine from <a href="https://drive.google.com/open?id=0B-Ab4Cb_awnScXpPeEhMUDYtQ1k" data-href="https://drive.google.com/open?id=0B-Ab4Cb_awnScXpPeEhMUDYtQ1k" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">google drive</a> (about 1.6 GB). And then, we should open the VM and from here you can find the import button at the top,</p><figure name="fbb6" id="fbb6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SfFwJENBmHJnUABv2J43Iw.png" data-width="1392" data-height="568" src="https://cdn-images-1.medium.com/max/800/1*SfFwJENBmHJnUABv2J43Iw.png"><figcaption class="imageCaption">Note: ignore `ECHO` and `minix3` in this pic</figcaption></figure><p name="7f94" id="7f94" class="graf graf--p graf-after--figure">After click on the import button, we can then choose an OVA file to import. In this case, our file is called <code class="markup--code markup--p-code">CS6290 Project VM.ova</code> . Then click on “Continue” to import the file,</p><figure name="4ab8" id="4ab8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*N1YKR1-ZxI5057FWf431vg.png" data-width="1458" data-height="374" src="https://cdn-images-1.medium.com/max/800/1*N1YKR1-ZxI5057FWf431vg.png"></figure><p name="d8e7" id="d8e7" class="graf graf--p graf-after--figure">Then, a list of settings of this virtual machine is now displayed for us. We can find out that the OS for our virtual machine is Ubuntu (32-bit) with 512 MB RAM. Click on “Import” to import this virtual machine,</p><figure name="eb2b" id="eb2b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*qIPNGdftbbp4TGMUpGa2yw.png" data-width="1412" data-height="626" src="https://cdn-images-1.medium.com/max/800/1*qIPNGdftbbp4TGMUpGa2yw.png"></figure><p name="1807" id="1807" class="graf graf--p graf-after--figure">Now, we are going to have this virtual machine in the VirtualBox,</p><figure name="2255" id="2255" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WXqpDbYOf6V0sJNWuAsMAw.png" data-width="1466" data-height="622" src="https://cdn-images-1.medium.com/max/800/1*WXqpDbYOf6V0sJNWuAsMAw.png"></figure><p name="14ba" id="14ba" class="graf graf--p graf-after--figure">And we can click on the button “Start” at the top to start this machine.</p><figure name="8d40" id="8d40" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ftIrYA3AoH_bliWgHP0bBQ.png" data-width="2098" data-height="802" src="https://cdn-images-1.medium.com/max/800/1*ftIrYA3AoH_bliWgHP0bBQ.png"></figure><p name="cfbe" id="cfbe" class="graf graf--p graf-after--figure">Note that you may want to change the display settings from the preference to <code class="markup--code markup--p-code">1920 * 1080</code> . To continue, let’s first shut down the machine.</p><p name="8f4d" id="8f4d" class="graf graf--p graf-after--p">A shared folder can be useful for backups and shared files. We can set up a shared folder with the following steps,</p><p name="ca9f" id="ca9f" class="graf graf--p graf-after--p">1) Create a directory on the host machine.</p><p name="a328" id="a328" class="graf graf--p graf-after--p">2) Shutdown the VM if it’s running.</p><p name="c017" id="c017" class="graf graf--p graf-after--p">3) In the settings for the VM, go to the “Shared Folders” tab.</p><p name="9540" id="9540" class="graf graf--p graf-after--p">4) Right-click “Machine Folders” then select “Add Shared Folder”.</p><p name="f5c9" id="f5c9" class="graf graf--p graf-after--p">5) Fill in this information:</p><ul class="postList"><li name="17b8" id="17b8" class="graf graf--li graf-after--p">Folder Path = {path to shared folder}</li><li name="537b" id="537b" class="graf graf--li graf-after--li">Auto-mount = checked</li></ul><p name="33d6" id="33d6" class="graf graf--p graf-after--li">6) Reboot the VM.</p><p name="8629" id="8629" class="graf graf--p graf-after--p">7) Find the shared folder under “/media” named with <code class="markup--code markup--p-code">sf_…</code>.</p><p name="e3ef" id="e3ef" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">2. Simulator Set-up</strong></p><p name="68a5" id="68a5" class="graf graf--p graf-after--p">The simulator in the <code class="markup--code markup--p-code">sesc</code> directory within our home directory, and we first need to build it.</p><pre name="2278" id="2278" class="graf graf--pre graf-after--p">$ cd ~/sesc<br>$ make</pre><p name="54d3" id="54d3" class="graf graf--p graf-after--pre">Then,</p><pre name="656f" id="656f" class="graf graf--pre graf-after--p">$ cd apps/Splash2/lu</pre><p name="3f75" id="3f75" class="graf graf--p graf-after--pre">Then,</p><pre name="7fbf" id="7fbf" class="graf graf--pre graf-after--p">$ make</pre><p name="76e5" id="76e5" class="graf graf--p graf-after--pre">In the same directory, run</p><pre name="3ebd" id="3ebd" class="graf graf--pre graf-after--p">$ ~/sesc/sesc.opt -fn64.rpt -c ~/sesc/confs/cmp4-noc.conf -olu.out     -elu.err lu.mipseb -n64 -p1</pre><p name="2f82" id="2f82" class="graf graf--p graf-after--pre">Where,</p><ul class="postList"><li name="d44c" id="d44c" class="graf graf--li graf-after--p">the <code class="markup--code markup--li-code">-f</code> option tells the simulator to create a report file that ends with a dot and the specified string. The name of the report file is <code class="markup--code markup--li-code">sesc_</code> followed by the name of the executable for the simulated application (<code class="markup--code markup--li-code">lu.mipseb</code> in this case), followed by a dot <code class="markup--code markup--li-code">.</code> and the string <code class="markup--code markup--li-code">n64.rpt</code> we specify here.</li><li name="f7cc" id="f7cc" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">-c</code> option tells the simulator which configuration file to use. In this case, we are using the file named <code class="markup--code markup--li-code">~/sesc/confs/cmp4-noc.conf</code> .</li><li name="94ca" id="94ca" class="graf graf--li graf-after--li">The <code class="markup--code markup--li-code">-o</code> and <code class="markup--code markup--li-code">-e</code> options tell it to save the standard and error output of the application into <code class="markup--code markup--li-code">lu.out</code> and <code class="markup--code markup--li-code">lu.err</code> files, respectively.</li><li name="65ed" id="65ed" class="graf graf--li graf-after--li">The <code class="markup--code markup--li-code">-n64</code> parameter tells the LU application (which does LU decomposition of a matrix) to work on a <code class="markup--code markup--li-code">64 * 64</code> matrix.</li><li name="1367" id="1367" class="graf graf--li graf-after--li">The <code class="markup--code markup--li-code">-p1</code> parameter tells the application to use only one core.</li></ul><p name="64b4" id="64b4" class="graf graf--p graf-after--li">Check there are no errors,</p><pre name="3e97" id="3e97" class="graf graf--pre graf-after--p">$ cat lu.err</pre><p name="e4bc" id="e4bc" class="graf graf--p graf-after--pre">And the output should end with <code class="markup--code markup--p-code">Total time without initialization: 0</code></p><pre name="5382" id="5382" class="graf graf--pre graf-after--p">$ cat lu.out</pre><p name="995a" id="995a" class="graf graf--p graf-after--pre">Note that there is also a report named <code class="markup--code markup--p-code">sesc_lu.mipseb.n64.rpt</code> that we can read the information about the command line we used, a copy of the hardware configuration we used, and then lots of information about the simulated execution we have just completed. To show this report, we can run,</p><pre name="de85" id="de85" class="graf graf--pre graf-after--p">$ ~/sesc/scripts/report.pl sesc_lu.mipseb.n64.rpt</pre><p name="38a3" id="38a3" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">3. Report Interpretation</strong></p><p name="62e9" id="62e9" class="graf graf--p graf-after--p">In this part, we are going to meet some concepts like <code class="markup--code markup--p-code">branch</code> . If you don’t understand these so far, don’t worry and we will explain more about these in the following sections.</p><p name="e0d7" id="e0d7" class="graf graf--p graf-after--p">The printout of the report script gives us the command line that was used, then tells us how fast the simulation was going by <code class="markup--code markup--p-code">Exe Speed</code>, how much real-time elapsed while the simulator was running <code class="markup--code markup--p-code">Exe Time</code>, and how much simulated time on the simulated machine it took to run the benchmark <code class="markup--code markup--p-code">Sim Time</code>. For example,</p><pre name="626e" id="626e" class="graf graf--pre graf-after--p">Exe Speed       Exe MHz         Exe Time         Sim Time (1000MHz)<br>---- KIPS       ---- MHz        ---- secs            ---- msec</pre><p name="921c" id="921c" class="graf graf--p graf-after--pre">The printout of the report script also tells us how accurate the simulated processor’s branch predictor was overall (the number under <code class="markup--code markup--p-code">Total</code>). The next two numbers are in parenthesis under the <code class="markup--code markup--p-code">RAS</code> label, and they report the accuracy of the return address stack <code class="markup--code markup--p-code">RAS</code> and what percentage of branches have actually used the <code class="markup--code markup--p-code">RAS</code>.</p><p name="6521" id="6521" class="graf graf--p graf-after--p">Next, under the <code class="markup--code markup--p-code">BPred</code> label, we have the accuracy for branches that didn’t use the <code class="markup--code markup--p-code">RAS</code> (i.e. they used the direction predictor and possibly the <code class="markup--code markup--p-code">BTB</code> and/or the <code class="markup--code markup--p-code">BTAC</code>), and then we have statistics for the <code class="markup--code markup--p-code">BTB</code> and <code class="markup--code markup--p-code">BTAC</code>, which are less interesting for now.</p><pre name="cdab" id="cdab" class="graf graf--pre graf-after--p">Total           RAS          BPred          BTB           BTAC<br>---- % ( ---- % of ---- %)   ---- % ( ---- % of ---- %)   ---- %</pre><p name="c9d4" id="c9d4" class="graf graf--p graf-after--pre">Next, the report tells us how many dynamic instructions were completed <code class="markup--code markup--p-code">nInst</code> (Instructions Count) and the breakdown of these instructions, i.e. the percentage of <code class="markup--code markup--p-code">nInst</code> that comes from control flow instructions like branches, jumps, calls, returns, etc. (the number under the <code class="markup--code markup--p-code">BJ</code> label), from loads <code class="markup--code markup--p-code">Load</code>, from stores <code class="markup--code markup--p-code">Store</code>, from integer ALU <code class="markup--code markup--p-code">INT</code>, and from floating-point ALU operations <code class="markup--code markup--p-code">FP</code>. The rest of that line (<code class="markup--code markup--p-code">LD Forward</code> and beyond) is less interesting for now. For example,</p><pre name="50dd" id="50dd" class="graf graf--pre graf-after--p">nInst BJ Load Store INT FP : LD Forward , Replay : Worst Unit (clk)</pre><p name="e3e7" id="e3e7" class="graf graf--p graf-after--pre">Next, the report tells us the overall <code class="markup--code markup--p-code">IPC</code> (Instructions per second) achieved by the simulated processor on this application, how many cycles the processor spent trying to execute instructions, and what those cycles were spent on. This last part is broken down into issuing useful instructions <code class="markup--code markup--p-code">Busy</code>, waiting for a load queue entry <code class="markup--code markup--p-code">LDQ</code> to become free, then the same for store queue <code class="markup--code markup--p-code">STQ</code>, reservation stations <code class="markup--code markup--p-code">IWin</code>, <code class="markup--code markup--p-code">ROB</code> entries, and physical registers (<code class="markup--code markup--p-code">Regs</code>, the simulator uses a Pentium 4-like separate physical register file for register renaming).</p><p name="e172" id="e172" class="graf graf--p graf-after--p">Some of the cycles are wasted on TLB misses <code class="markup--code markup--p-code">TLB</code>, on issuing wrong-path instructions due to branch mispredictions <code class="markup--code markup--p-code">MisBr</code>, and some other more obscure reasons (<code class="markup--code markup--p-code">Ports</code>, <code class="markup--code markup--p-code">maxBr</code>, <code class="markup--code markup--p-code">Br4Clk</code>, <code class="markup--code markup--p-code">Other</code>). Note that each of these “how the cycles were spent” items is a percentage although they do not have the percentage sign.</p><pre name="db25" id="db25" class="graf graf--pre graf-after--p">IPC Cycles Busy LDQ STQ IWin ROB Regs Ports TLB maxBr MisBr Br4Clk  Other</pre><p name="a1e2" id="a1e2" class="graf graf--p graf-after--pre graf--trailing">Also note that the simulator models a multiple-issue processor, so the breakdown of where the cycles went is actually attributing partial cycles when needed. For example, in a four-issue processor, we may have a cycle where one useful instruction is issued and then the processor could not issue another one because the <code class="markup--code markup--p-code">LDW</code> became full. In this cycle, 0.25 cycles would be counted as <code class="markup--code markup--p-code">Busy</code> and 0.75 cycles toward <code class="markup--code markup--p-code">LDQ</code>.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/7fa9ababc92b"><time class="dt-published" datetime="2021-01-17T14:00:06.095Z">January 17, 2021</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/high-performance-computer-architecture-5-set-up-the-virtual-machine-and-simulator-report-7fa9ababc92b" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>