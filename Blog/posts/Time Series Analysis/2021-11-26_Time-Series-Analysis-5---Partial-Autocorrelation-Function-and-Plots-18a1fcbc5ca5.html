<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Time Series Analysis 5 | Partial Autocorrelation Function and Plots</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Time Series Analysis 5 | Partial Autocorrelation Function and Plots</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Time Series Analysis
</section>
<section data-field="body" class="e-content">
<section name="e65b" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="4d06" id="4d06" class="graf graf--h3 graf--leading graf--title">Time Series Analysis 5 | <strong class="markup--strong markup--h3-strong">Partial Autocorrelation Function and Plots</strong></h3><figure name="6383" id="6383" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*1zbB637Y1IyOoNVgCdYw-g.png" data-width="1356" data-height="758" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*1zbB637Y1IyOoNVgCdYw-g.png"></figure><p name="adc1" id="adc1" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">1. Partial Autocorrelation Function (PACF)</strong></p><p name="07c2" id="07c2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Recall: ACF Plot for AR(<em class="markup--em markup--p-em">p</em>) and MA(<em class="markup--em markup--p-em">q</em>)</strong></p><ul class="postList"><li name="6a44" id="6a44" class="graf graf--li graf-after--p">AR(<em class="markup--em markup--li-em">p</em>): for stationary AR(<em class="markup--em markup--li-em">p</em>), it can be written as an MA(∞). Because the ACF plot of MA shuts off at <em class="markup--em markup--li-em">q</em> so that an MA(∞) ACF plot should never shut off theoretically. So the ACF plot may decay slowly and hard to judge sometimes.</li></ul><figure name="ddc4" id="ddc4" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*RNjZi_k-KhBBhiLPEZRJ-Q.png" data-width="828" data-height="188" src="https://cdn-images-1.medium.com/max/800/1*RNjZi_k-KhBBhiLPEZRJ-Q.png"><figcaption class="imageCaption">ϕ(x) = 1-0.8x</figcaption></figure><figure name="4bd3" id="4bd3" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*W1EEB1DDOoXzuKO7LA15vg.png" data-width="710" data-height="175" src="https://cdn-images-1.medium.com/max/800/1*W1EEB1DDOoXzuKO7LA15vg.png"><figcaption class="imageCaption">ϕ = 1 + 1.2x</figcaption></figure><ul class="postList"><li name="300e" id="300e" class="graf graf--li graf-after--figure">MA(<em class="markup--em markup--li-em">q</em>): Theoretically, MA(<em class="markup--em markup--li-em">q</em>) is a <em class="markup--em markup--li-em">q-</em>correlated process and should have 0 ACF when <em class="markup--em markup--li-em">h</em> &gt; <em class="markup--em markup--li-em">q</em>. ACF plot should shut off quickly and where it shuts off can give an estimate of <em class="markup--em markup--li-em">q.</em> For example, we can examine that the following ACF plot shut off at <em class="markup--em markup--li-em">h</em> = 2, so we can estimate this is a MA(2) process.</li></ul><figure name="5da7" id="5da7" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*0fsO8QCkTHWDBT9L9PSgCw.png" data-width="828" data-height="188" src="https://cdn-images-1.medium.com/max/800/1*0fsO8QCkTHWDBT9L9PSgCw.png"><figcaption class="imageCaption">sudden shut off compared with AR</figcaption></figure><p name="20d4" id="20d4" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) Recall: The Definition of Autocorrelation Function (ACF)</strong></p><p name="3d4c" id="3d4c" class="graf graf--p graf-after--p">ACF is the complete autocorrelation function where all X_t’s are random variables,</p><figure name="b44a" id="b44a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RsthV99rDIiFERfyedJ6VA.png" data-width="1338" data-height="120" src="https://cdn-images-1.medium.com/max/800/1*RsthV99rDIiFERfyedJ6VA.png"></figure><p name="e0fb" id="e0fb" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) The Definition of Partial Autocorrelation Function (PACF)</strong></p><p name="0be0" id="0be0" class="graf graf--p graf-after--p">While PACF is the conditional autocorrelation between X_t and X_{t+h} when x_{t+1}, …, x_{t+h-1} are fixed.</p><figure name="e0a1" id="e0a1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*3BYHNBHLpABh819uS4IOHA.png" data-width="1338" data-height="80" src="https://cdn-images-1.medium.com/max/800/1*3BYHNBHLpABh819uS4IOHA.png"></figure><p name="7c1b" id="7c1b" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) Simplified Version PACF</strong></p><p name="a37c" id="a37c" class="graf graf--p graf-after--p">Although this formula looks very challenging to estimate at the first glance, Brockwell and Davis (1991) showed in their book that PACF is equivalent to the correlation between the following two prediction errors,</p><figure name="9c9c" id="9c9c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bOVPqPRStMi1xGfvGRvfPA.png" data-width="1468" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*bOVPqPRStMi1xGfvGRvfPA.png"></figure><p name="5bba" id="5bba" class="graf graf--p graf-after--figure">And,</p><figure name="edfe" id="edfe" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_ayxvKX9LOd0VBMz_GJ4_w.png" data-width="1340" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*_ayxvKX9LOd0VBMz_GJ4_w.png"></figure><p name="a486" id="a486" class="graf graf--p graf-after--figure">where P is the <strong class="markup--strong markup--p-strong">prediction operator</strong> that is used to estimate X_t and X_{t+h} by using the condition of fixed X_{t+1}, …, X_{t+h-1}. For example,</p><figure name="bead" id="bead" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WGzoFlIm96YQCzoFy39E-Q.png" data-width="1350" data-height="98" src="https://cdn-images-1.medium.com/max/800/1*WGzoFlIm96YQCzoFy39E-Q.png"></figure><p name="515c" id="515c" class="graf graf--p graf-after--figure">This is to say that the PACF for {X_t} is also,</p><figure name="3a6e" id="3a6e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*h7z5DWUzUNcnIRfjB-i5FA.png" data-width="1340" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*h7z5DWUzUNcnIRfjB-i5FA.png"></figure><p name="d808" id="d808" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(5) Calculating PACF 1: Using Regression Residuals</strong></p><p name="24fe" id="24fe" class="graf graf--p graf-after--p">Based on the simplified version of PACF, we can generate two approaches to estimate PACF. The first approach is to calculate PACF based on the two regression residuals.</p><ul class="postList"><li name="fae6" id="fae6" class="graf graf--li graf-after--p">Fit the first OLS regression, then get the residuals Ɛ_{t+h}</li></ul><figure name="90e4" id="90e4" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*7-kvtmIb0PUe8mVeXIjFEA.png" data-width="1344" data-height="60" src="https://cdn-images-1.medium.com/max/800/1*7-kvtmIb0PUe8mVeXIjFEA.png"></figure><ul class="postList"><li name="5bf7" id="5bf7" class="graf graf--li graf-after--figure">Fit the second OLS regression, then get the residuals Ɛ_{t}</li></ul><figure name="c827" id="c827" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*mK0MJrGAuKaYlzxri3g9pA.png" data-width="1344" data-height="60" src="https://cdn-images-1.medium.com/max/800/1*mK0MJrGAuKaYlzxri3g9pA.png"></figure><ul class="postList"><li name="1ec2" id="1ec2" class="graf graf--li graf-after--figure">Then calculate the sample correlation between two sets of residual as the sample PACF. So the PACF(<em class="markup--em markup--li-em">h</em>) should be equivalent to,</li></ul><figure name="c5a5" id="c5a5" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*_Mif-5DGTUbSteP8AFZvaQ.png" data-width="1344" data-height="60" src="https://cdn-images-1.medium.com/max/800/1*_Mif-5DGTUbSteP8AFZvaQ.png"></figure><p name="3a5c" id="3a5c" class="graf graf--p graf-after--figure">However, this estimation does not look the same way as the practical models, so they figure out some ways to improve it.</p><p name="d7e5" id="d7e5" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(6) Calculating PACF 2: Yule-Walk Method</strong></p><p name="3ffe" id="3ffe" class="graf graf--p graf-after--p">Yule-Walk method is the default method used in Python, and we have to discuss it here because it gives a more accurate estimate of PACF. The basic idea is that the correlation coefficient of <code class="markup--code markup--p-code">X_{t}</code> and <code class="markup--code markup--p-code">X_{t+h}</code> should be equal to the parameter of the OLS regression estimation between them.</p><p name="9c0d" id="9c0d" class="graf graf--p graf-after--p">Therefore, this method understands the conditional <code class="markup--code markup--p-code">Corr(Xt+h, Xt)</code> as,</p><figure name="a78c" id="a78c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*w-EKS9spDopDKB3xfx4upw.png" data-width="1606" data-height="192" src="https://cdn-images-1.medium.com/max/800/1*w-EKS9spDopDKB3xfx4upw.png"></figure><p name="ddaf" id="ddaf" class="graf graf--p graf-after--figure">where β_h measures the proportion of the variance in <code class="markup--code markup--p-code">X_{t+h}</code> that is explained by <code class="markup--code markup--p-code">X_{t}</code>, and we can use it as an estimate of the value of the partial correlation.</p><p name="ff86" id="ff86" class="graf graf--p graf-after--p">Note that the expression above can also be written</p><figure name="aacb" id="aacb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*flwlcfIFbU6W0l8VOUXqMg.png" data-width="1340" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*flwlcfIFbU6W0l8VOUXqMg.png"></figure><p name="3b19" id="3b19" class="graf graf--p graf-after--figure">This can be written in the form of an AR(<em class="markup--em markup--p-em">h</em>) model,</p><figure name="c18a" id="c18a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Am3P7MwvLz9RqP0EtJRqTw.png" data-width="1340" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*Am3P7MwvLz9RqP0EtJRqTw.png"></figure><p name="ef7e" id="ef7e" class="graf graf--p graf-after--figure">And,</p><figure name="191a" id="191a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*oJ7PhHZLxHCFS0_aV3FrIA.png" data-width="1340" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*oJ7PhHZLxHCFS0_aV3FrIA.png"></figure><p name="b1cb" id="b1cb" class="graf graf--p graf-after--figure">To get this coefficient, we have to multiply this equation,</p><figure name="3fb0" id="3fb0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*MvtX4COX0OF-iVWLMLe5Bw.png" data-width="1340" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*MvtX4COX0OF-iVWLMLe5Bw.png"></figure><p name="88a8" id="88a8" class="graf graf--p graf-after--figure">On both of its sides by <code class="markup--code markup--p-code">X_{t-1}</code>, <code class="markup--code markup--p-code">X_{t-2}</code>, …, <code class="markup--code markup--p-code">X_{t-h}</code> respectively, and then take the expectation,</p><figure name="409c" id="409c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_gD32rcZ7tnJIGOuF9wrYQ.png" data-width="1350" data-height="232" src="https://cdn-images-1.medium.com/max/800/1*_gD32rcZ7tnJIGOuF9wrYQ.png"><figcaption class="imageCaption">Denote β in the last expression as φ_h because β is for the general case</figcaption></figure><p name="e5f4" id="e5f4" class="graf graf--p graf-after--figure">In matrix form, we have,</p><figure name="9691" id="9691" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*mot9v3EPj0gz2UD6y-ZqmQ.png" data-width="1340" data-height="236" src="https://cdn-images-1.medium.com/max/800/1*mot9v3EPj0gz2UD6y-ZqmQ.png"></figure><p name="322b" id="322b" class="graf graf--p graf-after--figure">This can be written as,</p><figure name="23b3" id="23b3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*75-p51-Gj-BrbCCWh2V3MA.png" data-width="1340" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*75-p51-Gj-BrbCCWh2V3MA.png"></figure><p name="e5e2" id="e5e2" class="graf graf--p graf-after--figure">Which is also,</p><figure name="ec6b" id="ec6b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wcQBlwn-93EMhgbkHmsWbg.png" data-width="1340" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*wcQBlwn-93EMhgbkHmsWbg.png"></figure><p name="641a" id="641a" class="graf graf--p graf-after--figure">Therefore, the estimate PACF(<em class="markup--em markup--p-em">h</em>) should be,</p><figure name="515d" id="515d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Swo4yA_WigP5q1S2Do3S4A.png" data-width="1340" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*Swo4yA_WigP5q1S2Do3S4A.png"><figcaption class="imageCaption">where PACF can also be denoted as α</figcaption></figure><p name="7c6e" id="7c6e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(7) Levinson-Durbin Recursion Algorithm</strong></p><p name="d7a3" id="d7a3" class="graf graf--p graf-after--p">Now, let’s discuss how can we calculate the inverse matrix of the least square coefficient covariance matrix. As our discussion, we can find out that the covariance matrix Γ_<em class="markup--em markup--p-em">h</em> is a <strong class="markup--strong markup--p-strong">Toeplitz matrix</strong>, which is defined as each of its descending diagonal from left to right is constant.</p><figure name="1226" id="1226" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*s-WU_ufFJDgOtTPrdV0fZw.png" data-width="1340" data-height="472" src="https://cdn-images-1.medium.com/max/800/1*s-WU_ufFJDgOtTPrdV0fZw.png"></figure><p name="584a" id="584a" class="graf graf--p graf-after--figure">For the Toeplitz matrix, we can apply the <strong class="markup--strong markup--p-strong">Levinson-Durbin recursion</strong> (which has a complexity of Θ(x²)) for calculating its reverse instead of the Gaussian elimination (which has a complexity of Θ(x³)). You can find out how we do Gaussian elimination by,</p><div name="ca8f" id="ca8f" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/adamedelwiess/linear-algebra-2-various-matrix-matrix-equations-gaussian-elimination-and-matrix-e9ef7f3b540f" data-href="https://medium.com/adamedelwiess/linear-algebra-2-various-matrix-matrix-equations-gaussian-elimination-and-matrix-e9ef7f3b540f" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/adamedelwiess/linear-algebra-2-various-matrix-matrix-equations-gaussian-elimination-and-matrix-e9ef7f3b540f"><strong class="markup--strong markup--mixtapeEmbed-strong">Linear Algebra 2 | Various Matrix, Matrix Equations, Gaussian Elimination, and Matrix…</strong><br><em class="markup--em markup--mixtapeEmbed-em">Series: Linear Algebra</em>medium.com</a><a href="https://medium.com/adamedelwiess/linear-algebra-2-various-matrix-matrix-equations-gaussian-elimination-and-matrix-e9ef7f3b540f" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6704afd962e82b23856bbd7ef7c5e739" data-thumbnail-img-id="1*Yj4DEKztkbPyDrnciYX9dQ.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*Yj4DEKztkbPyDrnciYX9dQ.jpeg);"></a></div><p name="a184" id="a184" class="graf graf--p graf-after--mixtapeEmbed">In <code class="markup--code markup--p-code">scipy.linalg</code> package of Python, the ordinary <code class="markup--code markup--p-code">solve</code> method calculate the inverse matrix by Gaussian elimination and the <code class="markup--code markup--p-code">solve_toeplitz</code> method calculate the inverse matrix by Levinson-Durbin recursion. For example,</p><pre name="ef68" id="ef68" class="graf graf--pre graf-after--p">import numpy as np<br>from scipy.linalg import toeplitz, solve, solve_toeplitz</pre><pre name="3428" id="3428" class="graf graf--pre graf-after--pre">c = np.array([1, 3, 6, 10])<br>r = np.array([1, -1, -2, -3])<br>T = toeplitz(c, r)<br>I = np.identity(4)</pre><pre name="39c3" id="39c3" class="graf graf--pre graf-after--pre"># Solve by Gaussian Elimination<br>inv_gaussian = solve(T, I)<br># Solve by Levinson-Durbin recursion<br>inv_levinson = solve_toeplitz((c, r), I)</pre><pre name="b9f1" id="b9f1" class="graf graf--pre graf-after--pre"># Check the result<br>print(&quot;Gaussian:\n&quot;, np.abs(np.round(np.dot(T, inv_gaussian))))<br>print(&quot;\nLevinson:\n&quot;, np.abs(np.round(np.dot(T, inv_levinson))))</pre><p name="9c11" id="9c11" class="graf graf--p graf-after--pre">And the output should be,</p><pre name="3c01" id="3c01" class="graf graf--pre graf-after--p">Gaussian:<br> [[1. 0. 0. 0.]<br> [0. 1. 0. 0.]<br> [0. 0. 1. 0.]<br> [0. 0. 0. 1.]]<br><br>Levinson:<br> [[1. 0. 0. 0.]<br> [0. 1. 0. 0.]<br> [0. 0. 1. 0.]<br> [0. 0. 0. 1.]]</pre><p name="57fb" id="57fb" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">2. PACF Plots</strong></p><p name="fd6a" id="fd6a" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Recall: ACF plots for MA</strong></p><p name="261d" id="261d" class="graf graf--p graf-after--p">Recall the ACF plots for <code class="markup--code markup--p-code">MA(1)</code> as we have discussed <a href="https://medium.com/adamedelwiess/time-series-analysis-2-stationary-time-series-and-theoretical-autocorrelation-function-491ecf5eaf0" data-href="https://medium.com/adamedelwiess/time-series-analysis-2-stationary-time-series-and-theoretical-autocorrelation-function-491ecf5eaf0" class="markup--anchor markup--p-anchor" target="_blank">in this article</a>,</p><figure name="4bc7" id="4bc7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4v0GHsROmQsJzgsZkryI3w.png" data-width="1340" data-height="182" src="https://cdn-images-1.medium.com/max/800/1*4v0GHsROmQsJzgsZkryI3w.png"></figure><p name="95ed" id="95ed" class="graf graf--p graf-after--figure">Also, for <code class="markup--code markup--p-code">MA(2)</code>, we can have,</p><figure name="5b3a" id="5b3a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*2_CLB4zTwVLPx2afYQpRgw.png" data-width="1340" data-height="248" src="https://cdn-images-1.medium.com/max/800/1*2_CLB4zTwVLPx2afYQpRgw.png"></figure><p name="1c35" id="1c35" class="graf graf--p graf-after--figure">Continue this process for <code class="markup--code markup--p-code">MA(q)</code>, we can find out that</p><figure name="be66" id="be66" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WQj32wUZCqqPD-elbdb_Rg.png" data-width="1340" data-height="150" src="https://cdn-images-1.medium.com/max/800/1*WQj32wUZCqqPD-elbdb_Rg.png"></figure><p name="5db7" id="5db7" class="graf graf--p graf-after--figure">So the ACF plot of a MA(q) process should shut off at <em class="markup--em markup--p-em">h</em> = <em class="markup--em markup--p-em">q</em>. For example,</p><figure name="5c8d" id="5c8d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*yp8bq-gQl5xvuGstgHZbtw.png" data-width="1604" data-height="384" src="https://cdn-images-1.medium.com/max/800/1*yp8bq-gQl5xvuGstgHZbtw.png"><figcaption class="imageCaption">This MA(3) process has an ACF plot shutting off at h=3.</figcaption></figure><p name="1c70" id="1c70" class="graf graf--p graf-after--figure">However, the ACF plot for AR doesn’t imply any information about the order (only decaying) and we ought to find another way out.</p><p name="83ec" id="83ec" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(2) PACF plots for AR</strong></p><p name="1452" id="1452" class="graf graf--p graf-after--p">PACF plot, instead, helps with identifying the AR(p) process and gives a suggestion for p. Let’s first see how it works.</p><p name="d60f" id="d60f" class="graf graf--p graf-after--p">For AR(1) process, we have,</p><figure name="5305" id="5305" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*vsWqP4AuVnPxj23H02C_hA.png" data-width="1350" data-height="56" src="https://cdn-images-1.medium.com/max/800/1*vsWqP4AuVnPxj23H02C_hA.png"></figure><p name="7373" id="7373" class="graf graf--p graf-after--figure">When <em class="markup--em markup--p-em">h</em> = 0, the PACF of this process should be,</p><figure name="61a8" id="61a8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EPRpY6hBLwRcFiVBEIAa_w.png" data-width="1350" data-height="56" src="https://cdn-images-1.medium.com/max/800/1*EPRpY6hBLwRcFiVBEIAa_w.png"></figure><p name="7b22" id="7b22" class="graf graf--p graf-after--figure">When <em class="markup--em markup--p-em">h</em> = 1, the PACF of this process should be,</p><figure name="f3c8" id="f3c8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*01ua5gq67LsRN6NBaJYcrw.png" data-width="1350" data-height="56" src="https://cdn-images-1.medium.com/max/800/1*01ua5gq67LsRN6NBaJYcrw.png"></figure><p name="42b3" id="42b3" class="graf graf--p graf-after--figure">When <em class="markup--em markup--p-em">h</em> = 2, we have,</p><figure name="abc3" id="abc3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*lnqu-rU4E87CT40L6esVCQ.png" data-width="1350" data-height="98" src="https://cdn-images-1.medium.com/max/800/1*lnqu-rU4E87CT40L6esVCQ.png"></figure><p name="aa09" id="aa09" class="graf graf--p graf-after--figure">And for the first expression, we have,</p><figure name="22f1" id="22f1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Cx5eWoTsFY6Gi7sYs5AV5A.png" data-width="1350" data-height="66" src="https://cdn-images-1.medium.com/max/800/1*Cx5eWoTsFY6Gi7sYs5AV5A.png"></figure><p name="7c20" id="7c20" class="graf graf--p graf-after--figure">And for the second expression, we have,</p><figure name="be83" id="be83" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*FPgM_4IvXrAw8XDSK66-qQ.png" data-width="1350" data-height="66" src="https://cdn-images-1.medium.com/max/800/1*FPgM_4IvXrAw8XDSK66-qQ.png"></figure><p name="da34" id="da34" class="graf graf--p graf-after--figure">Therefore, we have,</p><figure name="62b4" id="62b4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*xrVu-RkNvDfk7cfdGzoEyg.png" data-width="1350" data-height="66" src="https://cdn-images-1.medium.com/max/800/1*xrVu-RkNvDfk7cfdGzoEyg.png"></figure><p name="4099" id="4099" class="graf graf--p graf-after--figure">This is,</p><figure name="a1a1" id="a1a1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CtLJ9xw9RMyRYziikMDJQw.png" data-width="1350" data-height="66" src="https://cdn-images-1.medium.com/max/800/1*CtLJ9xw9RMyRYziikMDJQw.png"></figure><p name="ded2" id="ded2" class="graf graf--p graf-after--figure">Because noises {Z_t} are uncorrelated, we can then have,</p><figure name="8e1c" id="8e1c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*xNqKe0pikQMvdjNx3bVHRA.png" data-width="1350" data-height="66" src="https://cdn-images-1.medium.com/max/800/1*xNqKe0pikQMvdjNx3bVHRA.png"></figure><p name="4a08" id="4a08" class="graf graf--p graf-after--figure">Therefore, we have for <code class="markup--code markup--p-code">MA(1)</code>,</p><figure name="166d" id="166d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*tO9ymHNa0bEWJ9NXzuADoQ.png" data-width="1350" data-height="144" src="https://cdn-images-1.medium.com/max/800/1*tO9ymHNa0bEWJ9NXzuADoQ.png"></figure><p name="4f12" id="4f12" class="graf graf--p graf-after--figure">In general, for a <code class="markup--code markup--p-code u-paddingRight0 u-marginRight0">AR(<em class="markup--em markup--p-em">p</em>)</code> process, the PACF should be,</p><figure name="34e4" id="34e4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UTW8aMByYsuE8DwKjGcLjw.png" data-width="1350" data-height="200" src="https://cdn-images-1.medium.com/max/800/1*UTW8aMByYsuE8DwKjGcLjw.png"></figure><p name="3aa4" id="3aa4" class="graf graf--p graf-after--figure">So the PACF plot of an <code class="markup--code markup--p-code u-paddingRight0 u-marginRight0">AR(<em class="markup--em markup--p-em">q</em>)</code> process should shut off at <em class="markup--em markup--p-em">h</em> = <em class="markup--em markup--p-em">q</em>. For example,</p><figure name="8b30" id="8b30" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ix1nv-ofwWcwzoGM7PAFuQ.png" data-width="1810" data-height="358" src="https://cdn-images-1.medium.com/max/800/1*ix1nv-ofwWcwzoGM7PAFuQ.png"><figcaption class="imageCaption">This AR(1) process has a PACF plot shutting off at h=1.</figcaption></figure><p name="f30d" id="f30d" class="graf graf--p graf-after--figure graf--trailing">However, the PACF plot for the MA process is only decaying, and hard to tell where it shuts off. Note that if both the ACF plot and the PACF plot are decaying or shutting off, probably we are doing a combination of the ARMA model.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/18a1fcbc5ca5"><time class="dt-published" datetime="2021-11-26T05:23:53.867Z">November 26, 2021</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/time-series-analysis-5-partial-autocorrelation-function-and-plots-18a1fcbc5ca5" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>