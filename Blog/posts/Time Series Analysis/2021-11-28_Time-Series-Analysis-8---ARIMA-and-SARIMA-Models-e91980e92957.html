<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Time Series Analysis 8 | ARIMA and SARIMA Models</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Time Series Analysis 8 | ARIMA and SARIMA Models</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Time Series Analysis
</section>
<section data-field="body" class="e-content">
<section name="8b44" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5cfe" id="5cfe" class="graf graf--h3 graf--leading graf--title">Time Series Analysis 8 | ARIMA and SARIMA Models</h3><figure name="451f" id="451f" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*lRndcqUVzDUzqJlEWIpXyA.png" data-width="1398" data-height="782" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*lRndcqUVzDUzqJlEWIpXyA.png"></figure><p name="9522" id="9522" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">1. ARIMA Model</strong></p><p name="abc3" id="abc3" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) The Definition of ARIMA Model</strong></p><p name="acb6" id="acb6" class="graf graf--p graf-after--p">The Autoregressive Integrated Moving Average ARIMA(<em class="markup--em markup--p-em">p</em>, <em class="markup--em markup--p-em">d</em>, <em class="markup--em markup--p-em">q</em>) Process models a non-stationary time series {Y_t} that can be decomposed into an approximate polynomial trend <code class="markup--code markup--p-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--p-em">m</em>_t</code> and stationary remaining <code class="markup--code markup--p-code">R_t</code>. So,</p><figure name="b7e4" id="b7e4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aZ4FCu2WOBAhkx2bSc_BSg.png" data-width="1342" data-height="60" src="https://cdn-images-1.medium.com/max/800/1*aZ4FCu2WOBAhkx2bSc_BSg.png"><figcaption class="imageCaption">R_t can be modelized by ARMA(p, q)</figcaption></figure><p name="96b3" id="96b3" class="graf graf--p graf-after--figure">where <code class="markup--code markup--p-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--p-em">m</em>_t</code> is a polynomial with <em class="markup--em markup--p-em">d</em> terms,</p><figure name="9139" id="9139" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*iquCWerFx-T0v2fxjT3xjQ.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*iquCWerFx-T0v2fxjT3xjQ.png"></figure><p name="6dde" id="6dde" class="graf graf--p graf-after--figure">If we differencing Y_t by <em class="markup--em markup--p-em">d</em> times, then we can get a stationary <code class="markup--code markup--p-code">X_t</code> defined as,</p><figure name="ac12" id="ac12" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*562lmRMHMIQWZwRj9rFGLA.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*562lmRMHMIQWZwRj9rFGLA.png"><figcaption class="imageCaption">where ∇ is defined as (1-B)</figcaption></figure><p name="cf5f" id="cf5f" class="graf graf--p graf-after--figure">where B is the backward matrix for <code class="markup--code markup--p-code">Y_t</code> in this section, not for <code class="markup--code markup--p-code">X_t</code>.</p><p name="dacf" id="dacf" class="graf graf--p graf-after--p">Proof: when <em class="markup--em markup--p-em">d</em> = 1,</p><figure name="1c87" id="1c87" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*nW4LUOe882TaqptNw7Ctig.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*nW4LUOe882TaqptNw7Ctig.png"></figure><p name="2395" id="2395" class="graf graf--p graf-after--figure">Then,</p><figure name="94b2" id="94b2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ugsgdntG2TSJo0DxZZNq8g.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*ugsgdntG2TSJo0DxZZNq8g.png"></figure><p name="7f21" id="7f21" class="graf graf--p graf-after--figure">Then,</p><figure name="19d4" id="19d4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EmBIFhXtRCGr5BGC_t-6zw.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*EmBIFhXtRCGr5BGC_t-6zw.png"></figure><p name="ce33" id="ce33" class="graf graf--p graf-after--figure">So,</p><figure name="69e5" id="69e5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*O8neicRowMB-EZAypoWRhQ.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*O8neicRowMB-EZAypoWRhQ.png"><figcaption class="imageCaption">R_t-R_{t-1} is stationary when R_t is stationary</figcaption></figure><p name="d122" id="d122" class="graf graf--p graf-after--figure">So {X_t} is stationary.</p><p name="0365" id="0365" class="graf graf--p graf-after--p">When <em class="markup--em markup--p-em">d</em> = 2,</p><figure name="4271" id="4271" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*X611kvS4OULYMoVdkRj8vw.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*X611kvS4OULYMoVdkRj8vw.png"></figure><p name="6731" id="6731" class="graf graf--p graf-after--figure">In this case, {X_t} is also stationary.</p><p name="079a" id="079a" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(2) Expression of ARIMA Model</strong></p><p name="d507" id="d507" class="graf graf--p graf-after--p">In summary, if we have an ARIMA time series {Y_t},</p><figure name="9a30" id="9a30" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ZS0JxKAzE2LFYGYVNlc47A.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*ZS0JxKAzE2LFYGYVNlc47A.png"></figure><p name="eaf3" id="eaf3" class="graf graf--p graf-after--figure">where,</p><figure name="cda0" id="cda0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*MK0PFhKo4eDZteuFOoPnOA.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*MK0PFhKo4eDZteuFOoPnOA.png"></figure><p name="b998" id="b998" class="graf graf--p graf-after--figure">Because by the definition of the ARMA model,</p><figure name="2056" id="2056" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UuXFEO33SCK0Sy_7eD99mA.png" data-width="1344" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*UuXFEO33SCK0Sy_7eD99mA.png"></figure><p name="3e07" id="3e07" class="graf graf--p graf-after--figure">Then we have,</p><figure name="28f0" id="28f0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*g9tEG5RKWG_KtHo9RoAAuQ.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*g9tEG5RKWG_KtHo9RoAAuQ.png"></figure><p name="dec7" id="dec7" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) ARIMA Example</strong></p><p name="4574" id="4574" class="graf graf--p graf-after--p">Suppose we have an ARIMA model of,</p><figure name="5c63" id="5c63" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CaNU0EyZgo1WbUKtVkKJug.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*CaNU0EyZgo1WbUKtVkKJug.png"></figure><p name="dbd4" id="dbd4" class="graf graf--p graf-after--figure">Then we have Y_t as,</p><figure name="7af3" id="7af3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*NqM3tyBxlRPbZulXXkSTuQ.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*NqM3tyBxlRPbZulXXkSTuQ.png"></figure><p name="9d13" id="9d13" class="graf graf--p graf-after--figure">This is,</p><figure name="8b11" id="8b11" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*VVFJCC9-v2vF7c1nbNe8zg.png" data-width="1342" data-height="62" src="https://cdn-images-1.medium.com/max/800/1*VVFJCC9-v2vF7c1nbNe8zg.png"></figure><p name="3976" id="3976" class="graf graf--p graf-after--figure">Although this process seems like an AR(2) process, it is actually not because this process is not stationary.</p><p name="68a8" id="68a8" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(4) Parameter Selection</strong></p><ul class="postList"><li name="ac1e" id="ac1e" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Find <em class="markup--em markup--li-em">p</em> and <em class="markup--em markup--li-em">q</em></strong>: As we have discussed, if we want to find p and q, we should do auto-searchings based on AIC and BIC.</li><li name="5096" id="5096" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Find <em class="markup--em markup--li-em">d</em></strong>: We can decide the degree of differencing <em class="markup--em markup--li-em">d</em> based on the ACF plot and the PACF plot. Or we can keep differencing the time series data until ADF test shows stationary.</li></ul><p name="f0fa" id="f0fa" class="graf graf--p graf-after--li">The ACF and PACF plot for an ARMA(1,1) model should be,</p><figure name="e50f" id="e50f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pPN6ae1cZMmIuTpyVH0Row.png" data-width="1802" data-height="356" src="https://cdn-images-1.medium.com/max/800/1*pPN6ae1cZMmIuTpyVH0Row.png"></figure><p name="36b2" id="36b2" class="graf graf--p graf-after--figure">The ACF and PACF plot for an ARIMA(1,1,1) model should be,</p><figure name="a71d" id="a71d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wfoeNYGKs1wyvjb1LRjz0Q.png" data-width="1802" data-height="356" src="https://cdn-images-1.medium.com/max/800/1*wfoeNYGKs1wyvjb1LRjz0Q.png"></figure><p name="7755" id="7755" class="graf graf--p graf-after--figure">The ACF and PACF plot for an ARIMA(1,2,1) model should be,</p><figure name="c38d" id="c38d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*orHMhGsFqzf0e0brIp5ZsQ.png" data-width="1802" data-height="356" src="https://cdn-images-1.medium.com/max/800/1*orHMhGsFqzf0e0brIp5ZsQ.png"></figure><p name="9c88" id="9c88" class="graf graf--p graf-after--figure">The ACF and PACF plot for an ARIMA(1,3,1) model should be,</p><figure name="8ca9" id="8ca9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*dgeIpIRbAu14dexUTR_u_A.png" data-width="1802" data-height="356" src="https://cdn-images-1.medium.com/max/800/1*dgeIpIRbAu14dexUTR_u_A.png"></figure><p name="17f7" id="17f7" class="graf graf--p graf-after--figure">By this result, we can find out that the degree of differencing equals the number of the local maximum and the local minimum based on the ACF plot.</p><p name="b6cd" id="b6cd" class="graf graf--p graf-after--p">For example, we can first generate a simulated dataset <code class="markup--code markup--p-code">simulated_data</code> of ARIMA(1,3,1) data by,</p><pre name="6e62" id="6e62" class="graf graf--pre graf-after--p">import matplotlib.pyplot as plt<br>import numpy as np<br>from math import *<br>from statsmodels.tsa.arima_process import ArmaProcess<br>from statsmodels.graphics.tsaplots import plot_acf, plot_pacf</pre><pre name="c10e" id="c10e" class="graf graf--pre graf-after--pre">def plot_TS(title, TS, alpha=0.99):<br>    fig, ax = plt.subplots(1,3,figsize=(18,3))<br>    axes = ax.flatten()<br>    axes[0].plot(TS)<br>    axes[0].set_title(title)<br>    plot_acf(TS, ax=axes[1], lags=len(TS)*alpha)<br>    plot_pacf(TS, ax=axes[2], lags=len(TS)*alpha)<br>    plt.show()</pre><pre name="b5dc" id="b5dc" class="graf graf--pre graf-after--pre">ar = np.array([1, -0.5])<br>ma = np.array([1,0.2])<br>ARMA_object = ArmaProcess(ar, ma)<br>simulated_data = ARMA_object.generate_sample(nsample=1000)<br>trend = np.array([(15*x**3 - 1440*x**2 + 34200*x - 216000)/30000 for x in range(1000)])<br>simulated_data += trend<br>    <br>plot_TS(&quot;ARMA(1,3,1)&quot;, simulated_data, 0.99)</pre><p name="850e" id="850e" class="graf graf--p graf-after--pre">The plot printed should be,</p><figure name="9092" id="9092" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*oOhKrbQsX7JnUAqlDWE9pw.png" data-width="1802" data-height="356" src="https://cdn-images-1.medium.com/max/800/1*oOhKrbQsX7JnUAqlDWE9pw.png"><figcaption class="imageCaption">Note: this set is NOT d=1, we got an ACF like this because we grab too many data points</figcaption></figure><p name="cfd1" id="cfd1" class="graf graf--p graf-after--figure">Then the differencing function can be manually defined as,</p><pre name="0f32" id="0f32" class="graf graf--pre graf-after--p">def difference(dataset, interval=1, diff_deg=1):<br>    <br>    for j in range(diff_deg):<br>        diff = list()<br>        <br>        for i in range(interval, len(dataset)):<br>            value = dataset[i] - dataset[i - interval]<br>            diff.append(value)<br>            <br>        dataset = diff<br>        <br>    return diff</pre><p name="45de" id="45de" class="graf graf--p graf-after--pre">Then we can apply the difference function on the <code class="markup--code markup--p-code">simulated_data</code> with the differencing degree <code class="markup--code markup--p-code">1</code>, <code class="markup--code markup--p-code">2</code>, <code class="markup--code markup--p-code">3</code>, and <code class="markup--code markup--p-code">4</code>.</p><pre name="d257" id="d257" class="graf graf--pre graf-after--p">data_d_1 = difference(simulated_data, interval=1, diff_deg=1)<br>data_d_2 = difference(simulated_data, interval=1, diff_deg=2)<br>data_d_3 = difference(simulated_data, interval=1, diff_deg=3)<br>data_d_4 = difference(simulated_data, interval=1, diff_deg=4)</pre><p name="0a26" id="0a26" class="graf graf--p graf-after--pre">Then we should also define the function of the Augmented Dickey-Fuller test using the <code class="markup--code markup--p-code">statsmodels.tsa.stattools.adfuller</code> package.</p><pre name="e81e" id="e81e" class="graf graf--pre graf-after--p">from statsmodels.tsa.stattools import adfuller<br>import pandas as pd</pre><pre name="5744" id="5744" class="graf graf--pre graf-after--pre">def adf_test(timeseries):<br>    <br>    print (&#39;Results of Augmented Dickey-Fuller Test:&#39;)<br>    dftest = adfuller(timeseries, autolag=&#39;AIC&#39;)<br>    dfoutput = pd.Series(dftest[0:4], index=[&#39;Test Statistic&#39;,&#39;p-value&#39;,&#39;#Lags Used&#39;,&#39;Number of Observations Used&#39;])<br>    for key,value in dftest[4].items():<br>       dfoutput[&#39;Critical Value (%s)&#39;%key] = value<br>    print (dfoutput)</pre><p name="2bdc" id="2bdc" class="graf graf--p graf-after--pre">The p-value on the differencing data with differencing degrees <code class="markup--code markup--p-code">1</code>, <code class="markup--code markup--p-code">2</code>, <code class="markup--code markup--p-code">3</code>, and <code class="markup--code markup--p-code">4</code> of in my case should be (and you will generate a similar result),</p><pre name="0bd5" id="0bd5" class="graf graf--pre graf-after--p">deg-1: p-value                          0.994280<br>deg-2: p-value                          0.933897<br>deg-3: p-value                          1.236827e-29<br>deg-4: p-value                          0.000000</pre><p name="154d" id="154d" class="graf graf--p graf-after--pre">We can find out that, from this result, we will get a P-value ~ 0 when <em class="markup--em markup--p-em">d</em> = 3, therefore, we are able to conclude that the parameter degree. Note that different approaches may result in different conclusions and we have to use cross-validation + RMSE (or other metrics) to choose the parameters with the better prediction performance.</p><p name="3708" id="3708" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(5) Model Estimation and Forecasting</strong></p><p name="6c93" id="6c93" class="graf graf--p graf-after--p">After choosing the parameters, we can apply the CSS-MLE method to estimate the ARMA(<em class="markup--em markup--p-em">p</em>, <em class="markup--em markup--p-em">q</em>) model based on the differentiated data to get an estimate <code class="markup--code markup--p-code">X_t-hat</code>. After that, the trend is forecasted based on the <em class="markup--em markup--p-em">d</em> we selected. For example, for <em class="markup--em markup--p-em">d</em> = 1, we have,</p><figure name="c279" id="c279" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*0uDMu7CmGmUHvyk6CPmYZQ.png" data-width="1348" data-height="72" src="https://cdn-images-1.medium.com/max/800/1*0uDMu7CmGmUHvyk6CPmYZQ.png"></figure><p name="8cfd" id="8cfd" class="graf graf--p graf-after--figure">This is also,</p><figure name="ec6c" id="ec6c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*yGVTk8TSuFT34c3j6Ir4ug.png" data-width="1348" data-height="72" src="https://cdn-images-1.medium.com/max/800/1*yGVTk8TSuFT34c3j6Ir4ug.png"></figure><p name="16c0" id="16c0" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2. SARIMA Model</strong></p><p name="4226" id="4226" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) Trend Component </strong><code class="markup--code markup--p-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--p-strong">(<em class="markup--em markup--p-em">p</em>, <em class="markup--em markup--p-em">d</em>, <em class="markup--em markup--p-em">q</em>)</strong></code></p><p name="daa0" id="daa0" class="graf graf--p graf-after--p">The trend component is exactly the same as the ARIMA model, where we have,</p><ul class="postList"><li name="fd1c" id="fd1c" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code"><em class="markup--em markup--li-em">p</em></code>: Trend autoregression order.</li><li name="52cf" id="52cf" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code"><em class="markup--em markup--li-em">d</em></code>: Trend difference order.</li><li name="3edc" id="3edc" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code"><em class="markup--em markup--li-em">q</em></code>: Trend moving average order.</li></ul><p name="0b32" id="0b32" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(2) Seasonal Component </strong><code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">(P, D, Q)_m</strong></code></p><p name="f881" id="f881" class="graf graf--p graf-after--p">However, there are four more parameters we have to select because they are part of the SARIMA model,</p><ul class="postList"><li name="b59a" id="b59a" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">P</code>: Seasonal autoregressive order.</li><li name="cb77" id="cb77" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">D</code>: Seasonal difference order.</li><li name="a0e7" id="a0e7" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">Q</code>: Seasonal moving average order.</li><li name="eff4" id="eff4" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">m</code>: Seasonal lag, which is the number of time steps for a single seasonal period.</li></ul><p name="b995" id="b995" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(3) General Form of SARIMA Model</strong></p><p name="1c4e" id="1c4e" class="graf graf--p graf-after--p">Suppose we have a <code class="markup--code markup--p-code">SARIMA(p, d, q)(P, D, Q)_m</code> model and,</p><ul class="postList"><li name="ad55" id="ad55" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">D</code> is the seasonality differencing degree for reaching stationary</li><li name="22ba" id="22ba" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">P</code> is how <code class="markup--code markup--li-code">Y_t</code> is related to <code class="markup--code markup--li-code">Y_{t-m}</code> , <code class="markup--code markup--li-code">Y_{t-2m}</code> , … , <code class="markup--code markup--li-code">Y_{t-Pm}</code></li><li name="a499" id="a499" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">Q</code> is how <code class="markup--code markup--li-code">Z_t</code> is related to <code class="markup--code markup--li-code">Z_{t-m}</code> , <code class="markup--code markup--li-code">Z_{t-2m}</code> , … , <code class="markup--code markup--li-code">Z_{t-Qm}</code></li></ul><p name="96d0" id="96d0" class="graf graf--p graf-after--li">So we have,</p><figure name="dc2d" id="dc2d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RFoRsFqx2Gc05eYATsnppQ.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*RFoRsFqx2Gc05eYATsnppQ.png"></figure><p name="fa4c" id="fa4c" class="graf graf--p graf-after--figure">where B is the backward operator for <code class="markup--code markup--p-code">Y_t</code> and <code class="markup--code markup--p-code">X_t</code> is a stationary time series.</p><p name="ad72" id="ad72" class="graf graf--p graf-after--p">And <code class="markup--code markup--p-code">X_t</code> can be modelized by,</p><figure name="6a5c" id="6a5c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*AY0GjdsKV73joNHm15CFog.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*AY0GjdsKV73joNHm15CFog.png"></figure><p name="59f3" id="59f3" class="graf graf--p graf-after--figure">Where,</p><figure name="b5e3" id="b5e3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*qBPa_dQ98_f9GkEi8Lijog.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*qBPa_dQ98_f9GkEi8Lijog.png"></figure><p name="2630" id="2630" class="graf graf--p graf-after--figure">And,</p><figure name="be07" id="be07" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Lck_FoOGUK1QaKRXC7Xn7w.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*Lck_FoOGUK1QaKRXC7Xn7w.png"></figure><p name="00fd" id="00fd" class="graf graf--p graf-after--figure">So the overall general form of a <code class="markup--code markup--p-code">SARIMA(p, d, q)(P, D, Q)_m</code> model should be,</p><figure name="504c" id="504c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CeqCI-WmWEC93mdhQ1C2Xg.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*CeqCI-WmWEC93mdhQ1C2Xg.png"></figure><p name="6d2a" id="6d2a" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(4) Parameter Selection</strong></p><p name="2050" id="2050" class="graf graf--p graf-after--p">For additive model (i.e. seasonality pattern is independent to time), when D = 1 we have,</p><figure name="530a" id="530a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8wDLXg4JFPf-7JuKIHxWxA.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*8wDLXg4JFPf-7JuKIHxWxA.png"></figure><p name="bac9" id="bac9" class="graf graf--p graf-after--figure">For the multiplicative model (i.e. seasonality pattern is sensitive to time), we should take a log-transformation on <code class="markup--code markup--p-code">Y_t</code> first to turn it in an additive model <code class="markup--code markup--p-code">log-Y_t</code> ,</p><figure name="af7d" id="af7d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wM3o4p_XfxkkwD177LYUIQ.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*wM3o4p_XfxkkwD177LYUIQ.png"></figure><p name="b502" id="b502" class="graf graf--p graf-after--figure">Then we can apply D = 1 for <code class="markup--code markup--p-code">log-Y_t</code> as,</p><figure name="261d" id="261d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*fybposw7TbeMXSVUWAHaxA.png" data-width="1348" data-height="68" src="https://cdn-images-1.medium.com/max/800/1*fybposw7TbeMXSVUWAHaxA.png"></figure><p name="d5e7" id="d5e7" class="graf graf--p graf-after--figure">Here, we will only discuss the case when D = 1 and we can always choose D = 1 for any additive model or multiplicative model. Note that we don’t have to do trend differencing when D = 1 because the result <code class="markup--code markup--p-code">(1-B^m)</code> will include the case of <code class="markup--code markup--p-code">(1-B)</code>.</p><p name="8a30" id="8a30" class="graf graf--p graf-after--p graf--trailing">The parameter <code class="markup--code markup--p-code"><em class="markup--em markup--p-em">m</em></code> should be the same as the seasonality lag and we can choose it based on the time series plot and ACF plot.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/e91980e92957"><time class="dt-published" datetime="2021-11-28T22:16:56.852Z">November 28, 2021</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/time-series-analysis-8-arima-and-sarima-models-e91980e92957" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>