<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Time Series Analysis 6 | ARMA Estimation and Forecasting</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Time Series Analysis 6 | ARMA Estimation and Forecasting</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Time Series Analysis
</section>
<section data-field="body" class="e-content">
<section name="ea6b" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3af1" id="3af1" class="graf graf--h3 graf--leading graf--title">Time Series Analysis 6 | ARMA Estimation and Forecasting</h3><figure name="8ec0" id="8ec0" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*1zbB637Y1IyOoNVgCdYw-g.png" data-width="1356" data-height="758" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*1zbB637Y1IyOoNVgCdYw-g.png"></figure><ol class="postList"><li name="f2f2" id="f2f2" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">Stationary AR(<em class="markup--em markup--li-em">p</em>) and Invertible MA(<em class="markup--em markup--li-em">q</em>)</strong></li></ol><p name="17e7" id="17e7" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(1) Recall: The Definition of AR(<em class="markup--em markup--p-em">p</em>)</strong></p><figure name="887b" id="887b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wy2UgBkVFNZ0-m-pi1LKAw.png" data-width="1344" data-height="66" src="https://cdn-images-1.medium.com/max/800/1*wy2UgBkVFNZ0-m-pi1LKAw.png"></figure><p name="1d32" id="1d32" class="graf graf--p graf-after--figure">Or,</p><figure name="1ffb" id="1ffb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*IGKe38i3bwRClob1e5k-ZA.png" data-width="1344" data-height="54" src="https://cdn-images-1.medium.com/max/800/1*IGKe38i3bwRClob1e5k-ZA.png"></figure><p name="ab1e" id="ab1e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(2) Recall: Stationary Condition of AR(<em class="markup--em markup--p-em">p</em>)</strong></p><p name="0f5e" id="0f5e" class="graf graf--p graf-after--p">AR(p) is able to use for stationary data should be,</p><ul class="postList"><li name="d574" id="d574" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">For population</strong>: The roots of Φ(x) = 0 should lie outside the unit cycle of |x| ≤ 1 (i.e. this means we should have all roots |x| &gt; 1).</li><li name="98a4" id="98a4" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">For a sample</strong>: ADF test</li></ul><p name="1029" id="1029" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(3) Recall: The Definition of MA(<em class="markup--em markup--p-em">q</em>)</strong></p><figure name="5c80" id="5c80" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*gT12pIPSHukbJAeo35-CVw.png" data-width="1344" data-height="54" src="https://cdn-images-1.medium.com/max/800/1*gT12pIPSHukbJAeo35-CVw.png"></figure><p name="c14b" id="c14b" class="graf graf--p graf-after--figure">Or,</p><figure name="cbfc" id="cbfc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HsbIP_e9RIJKssmGl-EWDA.png" data-width="1344" data-height="54" src="https://cdn-images-1.medium.com/max/800/1*HsbIP_e9RIJKssmGl-EWDA.png"></figure><p name="40ec" id="40ec" class="graf graf--p graf-after--figure">We don’t have any condition for the MA process to be stationary.</p><p name="a47e" id="a47e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(4) Problem of Estimating MA(<em class="markup--em markup--p-em">q</em>)</strong></p><p name="6698" id="6698" class="graf graf--p graf-after--p">Although we don’t have to show a MA process is stationary or not, the MA process has some problems with its estimation.</p><ul class="postList"><li name="8f46" id="8f46" class="graf graf--li graf-after--p">Suppose we are given {X_t}, then we don’t have any actual observation on the noise {Z_t}.</li><li name="fd6a" id="fd6a" class="graf graf--li graf-after--li">When we use MLE to estimate an MA(<em class="markup--em markup--li-em">q</em>) process, there are cases that we have up to <code class="markup--code markup--li-code">2^q</code> local optimations.</li></ul><p name="3374" id="3374" class="graf graf--p graf-after--li">This is to say that if we have a certain MA process, we can not estimate it if we don’t constrain it with some conditions.</p><p name="a8b5" id="a8b5" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(5) Invertible Condition of MA(<em class="markup--em markup--p-em">q</em>)</strong></p><p name="7708" id="7708" class="graf graf--p graf-after--p">To make an MA process estimatiable, we have to add a condition. And as we have discussed that an AR(<em class="markup--em markup--p-em">p</em>) process can be written as an MA(∞) process, the MA(<em class="markup--em markup--p-em">q</em>) should also be able to be written as an AR(∞) process. Based on this idea, if we can rewrite an MA process to an AR process, we must then be able to make some useful estimations.</p><p name="e67c" id="e67c" class="graf graf--p graf-after--p">Recall that an MA(q) process should be,</p><figure name="74ca" id="74ca" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*2V2m8FAElCQMJV96c2jz0g.png" data-width="1344" data-height="54" src="https://cdn-images-1.medium.com/max/800/1*2V2m8FAElCQMJV96c2jz0g.png"></figure><p name="e2df" id="e2df" class="graf graf--p graf-after--figure">Then if we can estimate by it (i.e. it has an invertible generating function), it can be written as,</p><figure name="e0cc" id="e0cc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*nJgPw-jQ0o3naQe0zVw8Iw.png" data-width="1344" data-height="54" src="https://cdn-images-1.medium.com/max/800/1*nJgPw-jQ0o3naQe0zVw8Iw.png"></figure><p name="dfce" id="dfce" class="graf graf--p graf-after--figure">If we write the inverse of generating function as a convergent series expression, we can then have an AR(∞) process.</p><figure name="eec5" id="eec5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wKT4snItqrCnVlm7Xx4G8Q.png" data-width="1344" data-height="112" src="https://cdn-images-1.medium.com/max/800/1*wKT4snItqrCnVlm7Xx4G8Q.png"></figure><p name="39bb" id="39bb" class="graf graf--p graf-after--figure">So the invertible condition for MA(<em class="markup--em markup--p-em">q</em>) is that if the zero roots of the generating function Θ(B) are all outside the unit circle |x| ≤ 1 (i.e. this means we should have all roots |x| &gt; 1), we should be able to confirm that this MA(<em class="markup--em markup--p-em">q</em>) is invertible.</p><p name="a2ba" id="a2ba" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">2. ARMA Process</strong></p><p name="2342" id="2342" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) The Definition of ARMA Process</strong></p><p name="6d39" id="6d39" class="graf graf--p graf-after--p">Now that we have discussed the AR process and the MA process, let’s continue to discuss the ARMA process. {X_t} is an Autoregressive Moving Average Process (ARMA) with order <em class="markup--em markup--p-em">p</em> and <em class="markup--em markup--p-em">q</em> if,</p><figure name="8ff5" id="8ff5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RC4kJPJYaFIasHQgGhtYYA.png" data-width="1344" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*RC4kJPJYaFIasHQgGhtYYA.png"></figure><p name="51e2" id="51e2" class="graf graf--p graf-after--figure">This can also be written as,</p><figure name="eacd" id="eacd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wgR3ewvVshsAc8SDPj-h-w.png" data-width="1344" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*wgR3ewvVshsAc8SDPj-h-w.png"></figure><p name="c809" id="c809" class="graf graf--p graf-after--figure">With the generating functions, we can have,</p><figure name="2056" id="2056" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UuXFEO33SCK0Sy_7eD99mA.png" data-width="1344" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*UuXFEO33SCK0Sy_7eD99mA.png"></figure><p name="3291" id="3291" class="graf graf--p graf-after--figure">where,</p><figure name="0b12" id="0b12" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*p6e0LSF_sq8h7BrGXEFYjw.png" data-width="1344" data-height="64" src="https://cdn-images-1.medium.com/max/800/1*p6e0LSF_sq8h7BrGXEFYjw.png"></figure><p name="19df" id="19df" class="graf graf--p graf-after--figure">All ARMA models we are going to use for fitting data are assumed to satisfy the <strong class="markup--strong markup--p-strong">stationary condition</strong> (causality) for generation function Φ(B) and <strong class="markup--strong markup--p-strong">invertible condition</strong> for generation function Θ(B).</p><ul class="postList"><li name="191c" id="191c" class="graf graf--li graf-after--p">Stationary (like MA)</li></ul><figure name="6f75" id="6f75" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*TwNeMpX0zTK5bB7PHOA2Gg.png" data-width="2560" data-height="122" src="https://cdn-images-1.medium.com/max/800/1*TwNeMpX0zTK5bB7PHOA2Gg.png"></figure><ul class="postList"><li name="bb6a" id="bb6a" class="graf graf--li graf-after--figure">Invertible (like AR)</li></ul><figure name="6a94" id="6a94" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*ADO1H02O-5zWTvoBymRelQ.png" data-width="2560" data-height="122" src="https://cdn-images-1.medium.com/max/800/1*ADO1H02O-5zWTvoBymRelQ.png"></figure><p name="16e3" id="16e3" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) ARMA Fitting Process</strong></p><p name="94fa" id="94fa" class="graf graf--p graf-after--p">In practice, if we identities the stationary condition of data from the plots and tests, what are the steps to take in order to fit the model ARMA(p, q)?</p><ul class="postList"><li name="a4c8" id="a4c8" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Order selection</strong>: If we have only an AR process or MA process, then we can get a suggested order from the ACF plot or the PACF plot. However, if we need to fit a general ARMA(<em class="markup--em markup--li-em">p</em>, <em class="markup--em markup--li-em">q</em>) process, we should start from different pairs of <em class="markup--em markup--li-em">p</em> and <em class="markup--em markup--li-em">q</em>, and then choose the one with the smallest AIC or BIC on <strong class="markup--strong markup--li-strong">the whole dataset</strong>. Then we should use metrics for prediction performance as <strong class="markup--strong markup--li-strong">RMSE</strong>, <strong class="markup--strong markup--li-strong">MAE</strong>, or <strong class="markup--strong markup--li-strong">MAPE</strong> with <strong class="markup--strong markup--li-strong">cross-validation</strong> and <strong class="markup--strong markup--li-strong">train-test validation</strong>. We are going to talk about this later.</li><li name="9fd8" id="9fd8" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Model Estimation</strong>: Generally, we are going to use MLE + recursive algorithm (for searching) for this problem. The recursive algorithm is Kalman-filter Recursive Algorithm (aka. <code class="markup--code markup--li-code">MLE-CSS</code>) in Python. In an ARMA model, we have to estimate the following (<em class="markup--em markup--li-em">p</em> + <em class="markup--em markup--li-em">q</em> + 1) parameters,</li></ul><figure name="5283" id="5283" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*Wx8kNbhDEcjyeLmUHwdnMw.png" data-width="1342" data-height="60" src="https://cdn-images-1.medium.com/max/800/1*Wx8kNbhDEcjyeLmUHwdnMw.png"><figcaption class="imageCaption">We have known p and q from the order selection phase</figcaption></figure><ul class="postList"><li name="5fe3" id="5fe3" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">Forecasting</strong></li></ul><p name="215e" id="215e" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">(4) Estimating ARMA(<em class="markup--em markup--p-em">p</em>, <em class="markup--em markup--p-em">q</em>)</strong></p><p name="49e7" id="49e7" class="graf graf--p graf-after--p">So now what we have to do is to estimate all the coefficients of an ARMA(<em class="markup--em markup--p-em">p</em>, <em class="markup--em markup--p-em">q</em>) model and the likelihood function should be,</p><figure name="58cc" id="58cc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*nFUCAB0D6plI9vx0xFyr3A.png" data-width="1342" data-height="134" src="https://cdn-images-1.medium.com/max/800/1*nFUCAB0D6plI9vx0xFyr3A.png"></figure><p name="9f27" id="9f27" class="graf graf--p graf-after--figure">Although the distribution assumption doesn’t matter for a log-likelihood result, the commonest one is a Gaussian distribution. So we will have,</p><figure name="3f3a" id="3f3a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*si__XmAZyfX2bze4biYnOg.png" data-width="1342" data-height="234" src="https://cdn-images-1.medium.com/max/800/1*si__XmAZyfX2bze4biYnOg.png"><figcaption class="imageCaption">X_t follows a multivariate normal distribution</figcaption></figure><p name="1738" id="1738" class="graf graf--p graf-after--figure">where the covariance matrix should be,</p><figure name="c3ff" id="c3ff" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*30qRyAWYNDPC-FtymLIgmg.png" data-width="1342" data-height="276" src="https://cdn-images-1.medium.com/max/800/1*30qRyAWYNDPC-FtymLIgmg.png"><figcaption class="imageCaption">This has the same algorithm as PACF</figcaption></figure><p name="1555" id="1555" class="graf graf--p graf-after--figure">Note that the mean of this distribution doesn’t necessarily need to be 0, because we can shift the data up or down.</p><figure name="eefd" id="eefd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*NChoZbGH0NxIPFO9spfkTw.png" data-width="1342" data-height="234" src="https://cdn-images-1.medium.com/max/800/1*NChoZbGH0NxIPFO9spfkTw.png"><figcaption class="imageCaption">Z_t follows a multivariate normal distribution</figcaption></figure><p name="8b38" id="8b38" class="graf graf--p graf-after--figure">So the likelihood function with MVN assumption should be,</p><figure name="b704" id="b704" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*rIUjvgO2hRvYMUdhEqo-1A.png" data-width="1342" data-height="102" src="https://cdn-images-1.medium.com/max/800/1*rIUjvgO2hRvYMUdhEqo-1A.png"></figure><p name="5af2" id="5af2" class="graf graf--p graf-after--figure">And our goal should be,</p><figure name="70e9" id="70e9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*oWgzfZvAaKJwOC0ZmbuFbA.png" data-width="1342" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*oWgzfZvAaKJwOC0ZmbuFbA.png"></figure><p name="6146" id="6146" class="graf graf--p graf-after--figure">And we can denote this as,</p><figure name="78a6" id="78a6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pgCeUhIkVqAf7orC8el2Rw.png" data-width="1342" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*pgCeUhIkVqAf7orC8el2Rw.png"></figure><p name="12e3" id="12e3" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(5) MLE-CSS Method</strong></p><p name="565f" id="565f" class="graf graf--p graf-after--p">In order to maximize the likelihood function of this ARMA process, we have to find a way on calculating the determinate of Γ_{n+1} and the inverse matrix of Γ_{n+1}. Let’s first have these two definitions,</p><ul class="postList"><li name="26bd" id="26bd" class="graf graf--li graf-after--p">The Prediction Error</li></ul><figure name="4384" id="4384" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*6eE4_4nb3IKX4zE5Q7IqhA.png" data-width="1342" data-height="70" src="https://cdn-images-1.medium.com/max/800/1*6eE4_4nb3IKX4zE5Q7IqhA.png"></figure><ul class="postList"><li name="567b" id="567b" class="graf graf--li graf-after--figure">The Mean Square Error</li></ul><figure name="8e8b" id="8e8b" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*zfR34J6TDt8ykDuIPXHYvw.png" data-width="1342" data-height="88" src="https://cdn-images-1.medium.com/max/800/1*zfR34J6TDt8ykDuIPXHYvw.png"></figure><p name="3d6d" id="3d6d" class="graf graf--p graf-after--figure">Also, we have to make an assumption of,</p><figure name="44a7" id="44a7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Toshfv5pHuHM3yJLH65kTw.png" data-width="1342" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*Toshfv5pHuHM3yJLH65kTw.png"><figcaption class="imageCaption">The estimate of X_0 should be the mean value as 0.</figcaption></figure><p name="655f" id="655f" class="graf graf--p graf-after--figure">Because there is no previous data to be used for estimate X_0 <code class="markup--code markup--p-code">X_0-hat</code>. So for the estimate of X_1 <code class="markup--code markup--p-code">X_1-hat</code>, we can have,</p><figure name="b4b8" id="b4b8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*-0K4aplmBiYH_3bwyp5O4Q.png" data-width="1342" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*-0K4aplmBiYH_3bwyp5O4Q.png"></figure><p name="8f44" id="8f44" class="graf graf--p graf-after--figure">Then,</p><figure name="0992" id="0992" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*PH2BC2kL0X8DxrHZwJyYVA.png" data-width="1342" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*PH2BC2kL0X8DxrHZwJyYVA.png"></figure><p name="eea3" id="eea3" class="graf graf--p graf-after--figure">For the estimate of X_2, we can have,</p><figure name="eab2" id="eab2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Yo_Sb-HwkAwXfILHjfX2rA.png" data-width="1342" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*Yo_Sb-HwkAwXfILHjfX2rA.png"></figure><p name="377e" id="377e" class="graf graf--p graf-after--figure">Then,</p><figure name="3a16" id="3a16" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*-TeMY2Q2HMLSUd3d4vTx6w.png" data-width="1342" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*-TeMY2Q2HMLSUd3d4vTx6w.png"></figure><p name="226a" id="226a" class="graf graf--p graf-after--figure">Continue and we can finally have,</p><figure name="4076" id="4076" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*vgdVYML7a-vNaKxqn0VWJA.png" data-width="1342" data-height="270" src="https://cdn-images-1.medium.com/max/800/1*vgdVYML7a-vNaKxqn0VWJA.png"><figcaption class="imageCaption">Coefficients a’s are the value of coefficients β’s plus the signs.</figcaption></figure><p name="b4f4" id="b4f4" class="graf graf--p graf-after--figure">In the matrix form, we can have,</p><figure name="0d48" id="0d48" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*uDfLjTJNLonmU10_mIyEjA.png" data-width="1342" data-height="76" src="https://cdn-images-1.medium.com/max/800/1*uDfLjTJNLonmU10_mIyEjA.png"></figure><p name="6d4b" id="6d4b" class="graf graf--p graf-after--figure">where,</p><figure name="d8e9" id="d8e9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*xbD1uia7MH08wbjNHgTO1g.png" data-width="1342" data-height="262" src="https://cdn-images-1.medium.com/max/800/1*xbD1uia7MH08wbjNHgTO1g.png"></figure><p name="b82b" id="b82b" class="graf graf--p graf-after--figure">We can find out that the A_n matrix is a lower triangular matrix and this matrix is invertible if and only if no element on its principal diagonal is 0. Based on the format of A_n, we can say that A_n is an invertible matrix. So,</p><figure name="977e" id="977e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Oi_C_TANFPOTzhKHaxonsA.png" data-width="1342" data-height="78" src="https://cdn-images-1.medium.com/max/800/1*Oi_C_TANFPOTzhKHaxonsA.png"></figure><p name="7bac" id="7bac" class="graf graf--p graf-after--figure">Because by definition of prediction error,</p><figure name="74c1" id="74c1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ST_oNM8IZ3jqp1xfB3BTFg.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*ST_oNM8IZ3jqp1xfB3BTFg.png"></figure><p name="a7e1" id="a7e1" class="graf graf--p graf-after--figure">We can then have,</p><figure name="5c12" id="5c12" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*98BVoMocu-xCaW3kPNaflQ.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*98BVoMocu-xCaW3kPNaflQ.png"></figure><p name="4c8f" id="4c8f" class="graf graf--p graf-after--figure">which can be written as,</p><figure name="3c4d" id="3c4d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4y14w1pFMnwPOBznWoRpbQ.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*4y14w1pFMnwPOBznWoRpbQ.png"></figure><p name="e9c7" id="e9c7" class="graf graf--p graf-after--figure">And the Λ matrix should be,</p><figure name="d2f6" id="d2f6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4emoCiT8tuL9S-mzNr5_7A.png" data-width="1342" data-height="280" src="https://cdn-images-1.medium.com/max/800/1*4emoCiT8tuL9S-mzNr5_7A.png"></figure><p name="e1a0" id="e1a0" class="graf graf--p graf-after--figure">So we have,</p><ul class="postList"><li name="4478" id="4478" class="graf graf--li graf-after--p">The estimate of X_{t} can be calculated by using the residuals from the previous steps (i.e. the observed values and the estimated values).</li><li name="1cbc" id="1cbc" class="graf graf--li graf-after--li">In each step, we can update the model and the coefficients λ’s.</li></ul><p name="2933" id="2933" class="graf graf--p graf-after--li">But how to calculate λ’s? In fact, the coefficient λ’s can be calculated recursively with MSE ν_{t+1} by,</p><ul class="postList"><li name="5f45" id="5f45" class="graf graf--li graf-after--p">Starting from,</li></ul><figure name="41f9" id="41f9" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*Ot4IygPqZaCYvkzBFDb2wg.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*Ot4IygPqZaCYvkzBFDb2wg.png"><figcaption class="imageCaption">This is also the sample variance.</figcaption></figure><ul class="postList"><li name="9692" id="9692" class="graf graf--li graf-after--figure">Then,</li></ul><figure name="fc19" id="fc19" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*Ev3hJ5x9PE1BjnEx1MYI4Q.png" data-width="1342" data-height="106" src="https://cdn-images-1.medium.com/max/800/1*Ev3hJ5x9PE1BjnEx1MYI4Q.png"></figure><ul class="postList"><li name="5481" id="5481" class="graf graf--li graf-after--figure">And,</li></ul><figure name="d45d" id="d45d" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*Du7s3hQb0ec6SlDUpetdYw.png" data-width="1342" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*Du7s3hQb0ec6SlDUpetdYw.png"></figure><p name="6bab" id="6bab" class="graf graf--p graf-after--figure">This algorithm helps reduce the MLE by,</p><figure name="7c4b" id="7c4b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*15oYdRvtCDGHTKDnGvTvkg.png" data-width="1342" data-height="70" src="https://cdn-images-1.medium.com/max/800/1*15oYdRvtCDGHTKDnGvTvkg.png"></figure><p name="9fb7" id="9fb7" class="graf graf--p graf-after--figure">And the sum of squares should be,</p><figure name="2964" id="2964" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*VGj7-Wb8toCr24CuXsLZsg.png" data-width="1342" data-height="104" src="https://cdn-images-1.medium.com/max/800/1*VGj7-Wb8toCr24CuXsLZsg.png"></figure><p name="2e17" id="2e17" class="graf graf--p graf-after--figure">where,</p><figure name="fc92" id="fc92" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*C1aM3ZDKNvl0DFEVyTC2Qw.png" data-width="1342" data-height="156" src="https://cdn-images-1.medium.com/max/800/1*C1aM3ZDKNvl0DFEVyTC2Qw.png"></figure><p name="3239" id="3239" class="graf graf--p graf-after--figure">So the likelihood function is then equivalent to,</p><figure name="a2e9" id="a2e9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1fcc5JRC4QTdjY1ZUm-Lzw.png" data-width="1342" data-height="102" src="https://cdn-images-1.medium.com/max/800/1*1fcc5JRC4QTdjY1ZUm-Lzw.png"></figure><p name="726e" id="726e" class="graf graf--p graf-after--figure">Now, let’s check back our basic assumption,</p><figure name="c2b4" id="c2b4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Toshfv5pHuHM3yJLH65kTw.png" data-width="1342" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*Toshfv5pHuHM3yJLH65kTw.png"></figure><p name="6e90" id="6e90" class="graf graf--p graf-after--figure">And we can find out that this can be violated in many practical cases. If the mean is not zero, we have the ARMA model on the centered data and the noise doesn’t change. So in Python, we assume the expectation of {X_t} equals to the sample mean,</p><figure name="af20" id="af20" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*s1OTx42asVd1iv1Kk2gaAA.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*s1OTx42asVd1iv1Kk2gaAA.png"></figure><p name="b19c" id="b19c" class="graf graf--p graf-after--figure">So we have the ARMA model as,</p><figure name="fa5e" id="fa5e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EaxPbXr58lvHcqhoDR7pTQ.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*EaxPbXr58lvHcqhoDR7pTQ.png"></figure><p name="7a43" id="7a43" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(6) ARMA Forecasting</strong></p><p name="d641" id="d641" class="graf graf--p graf-after--p">To forecast an ARMA model, we have to use the previous residuals to estimate noises. For example, for an ARMA(2,1) process,</p><figure name="ce78" id="ce78" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*fsM0xH7BnXahA4Mwu5CA2g.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*fsM0xH7BnXahA4Mwu5CA2g.png"></figure><p name="e7e9" id="e7e9" class="graf graf--p graf-after--figure">For X_1, we can not go back the whole way because we only have 1 historical data point X_0.</p><figure name="1232" id="1232" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*zRFyVC7kZCHniDoYGYpJiw.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*zRFyVC7kZCHniDoYGYpJiw.png"></figure><p name="97a1" id="97a1" class="graf graf--p graf-after--figure">Continue, we have,</p><figure name="02af" id="02af" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*OT_i92QVH9sUHX1BK7Ks9w.png" data-width="1342" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*OT_i92QVH9sUHX1BK7Ks9w.png"></figure><p name="4464" id="4464" class="graf graf--p graf-after--figure">This is the end of our sample, but we can also continue this for forecasting by the out-of-sample data (i.e. estimated data). However, we will finally lose the support of the real historical data, and the changes will become smaller and smaller. So an ARMA model is good at predicting the short-term future but bad at predicting the long-term future, and long-term forecasting tends to become flat. The more reliance on the previous data, the quicker the forecasting becomes flat, this is because if the time series does not exhibit any obvious structure, like trend or seasonality, a flat line of mean is the best forecast. You can find an example <a href="https://stats.stackexchange.com/questions/286900/arima-forecast-straight-line" data-href="https://stats.stackexchange.com/questions/286900/arima-forecast-straight-line" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><figure name="c171" id="c171" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*V1Kua5Tc-pWiF1xDfCEytw.png" data-width="1236" data-height="450" src="https://cdn-images-1.medium.com/max/800/1*V1Kua5Tc-pWiF1xDfCEytw.png"><figcaption class="imageCaption">This is an example that if we don’t assign the proper seasonal lag, the ARMA model will have flat forecasting.</figcaption></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/829a8b464767"><time class="dt-published" datetime="2021-11-26T05:26:20.985Z">November 26, 2021</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/time-series-analysis-6-arma-estimation-and-forecasting-829a8b464767" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>