<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Data Acquisition 8 | Internet Cookies</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Data Acquisition 8 | Internet Cookies</h1>
</header>
<section data-field="subtitle" class="p-summary">
Series: Data Acquisition
</section>
<section data-field="body" class="e-content">
<section name="f269" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="6b89" id="6b89" class="graf graf--h3 graf--leading graf--title">Data Acquisition 8 | Internet Cookies</h3><figure name="85a2" id="85a2" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*2NPkN8u7eMNtgJj1yzKnPw.png" data-width="1310" data-height="746" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*2NPkN8u7eMNtgJj1yzKnPw.png"></figure><ol class="postList"><li name="a3b9" id="a3b9" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">What is Cookie?</strong></li></ol><p name="67e3" id="67e3" class="graf graf--p graf-after--li">Some people believe the name for internet cookies came from the fairy tale about two children called Hansel and Gretel. The children were able to mark their trail through a dark forest by dropping “cookie crumbs” behind them so that they could see where they had been. This story paints a nice picture of the ability that internet cookies have to track your activity.</p><p name="44c4" id="44c4" class="graf graf--p graf-after--p">We have to use cookies because <strong class="markup--strong markup--p-strong">HTTP is a stateless protocol</strong>. For multiple requests from a browser, the server can not identify all these requests are from the same browser. So cookies are the extra data stored in our browser used for maintaining the communication between the client and the server.</p><p name="041e" id="041e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">2. Setup a Server Using Cookies</strong></p><p name="f83b" id="f83b" class="graf graf--p graf-after--p">To set up a web server locally or remotely (on AWS) that uses the sample cookies, we can use the following flask script.</p><figure name="0d1c" id="0d1c" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/2055463c7847bc3c325f4b51b47c34cf.js"></script></figure><p name="9f2c" id="9f2c" class="graf graf--p graf-after--figure">The Jinja templates for this script are (remember to put in the templates folder),</p><figure name="b29e" id="b29e" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/36d98aa9feb30a4325fa83f6b2fecce6.js"></script></figure><p name="81c6" id="81c6" class="graf graf--p graf-after--figure">Type in,</p><pre name="e321" id="e321" class="graf graf--pre graf-after--p">$ python server.py</pre><p name="12bd" id="12bd" class="graf graf--p graf-after--pre">to run this code, we go to the port 5000 on your server (mine is 18.222.232.14) to communicate with it. We can use F12 to check that we have no cookies now. We can also go to the setting page of the chrome and check that we have no cookies on this webpage.</p><figure name="2eb4" id="2eb4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CrMf66TmUrEeGbr-fRvC_w.png" data-width="1690" data-height="576" src="https://cdn-images-1.medium.com/max/800/1*CrMf66TmUrEeGbr-fRvC_w.png"></figure><p name="e172" id="e172" class="graf graf--p graf-after--figure">On this page, we can freely write anything in the input text box. For example, we can type in,</p><pre name="9b36" id="9b36" class="graf graf--pre graf-after--p">Hello</pre><p name="e3da" id="e3da" class="graf graf--p graf-after--pre">and then press Login. Then we are going to be directed to a page that tells us the cookie is set successfully. We can find out that now we have a record of a cookie and this cookie is stored in our browser. Every time we connect to this server, this cookie will be sent to the server to identify who we are.</p><figure name="dfcc" id="dfcc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wDq6nxrOG5v-NWEtqQk7Ig.png" data-width="1690" data-height="576" src="https://cdn-images-1.medium.com/max/800/1*wDq6nxrOG5v-NWEtqQk7Ig.png"></figure><p name="6f7d" id="6f7d" class="graf graf--p graf-after--figure">Let’s click on the link to read the cookie.</p><figure name="a14e" id="a14e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*7XLf1Yd4mAYCt6A9i654Rg.png" data-width="1690" data-height="576" src="https://cdn-images-1.medium.com/max/800/1*7XLf1Yd4mAYCt6A9i654Rg.png"></figure><p name="6e3d" id="6e3d" class="graf graf--p graf-after--figure">On this page, the cookie Hello will be sent back to us on the webpage and we can then know what is the cookie that we have set for our browser. Now, if we go to the page of,</p><pre name="d3d6" id="d3d6" class="graf graf--pre graf-after--p">&lt;server ip&gt;:5000</pre><p name="0ad9" id="0ad9" class="graf graf--p graf-after--pre">The server will know who we are and we do not have to set the cookie for a second time! So the server will redirect us to the /getcookie page.</p><p name="549d" id="549d" class="graf graf--p graf-after--p">Now, let’s click on the link that will delete the cookie for this website. Hola! The cookie is now deleted and the server doesn’t know who we are again. We can then re-log to the server for a second time.</p><figure name="4295" id="4295" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*vzjf709rKejVy-3kIFNutw.png" data-width="1690" data-height="542" src="https://cdn-images-1.medium.com/max/800/1*vzjf709rKejVy-3kIFNutw.png"></figure><p name="8366" id="8366" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">3. Cookie Forgery 1:</strong> <strong class="markup--strong markup--p-strong">Cheat The Server By Cookies</strong></p><p name="f74a" id="f74a" class="graf graf--p graf-after--p">Because the cookies are stored in our browser, of course, we can also cheat the server by changing the cookie. The server won’t know anything about it! To change the cookie on our browser, we have to use an extension called <a href="https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en" data-href="https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">EditThisCookie</a>. First of all, we have to download this extension and install it on our computer.</p><figure name="c66b" id="c66b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*qIEUea9Cb4oyH9zLlTK5GQ.png" data-width="2164" data-height="1286" src="https://cdn-images-1.medium.com/max/800/1*qIEUea9Cb4oyH9zLlTK5GQ.png"></figure><p name="74b4" id="74b4" class="graf graf--p graf-after--figure">Then we go back to our server. The extension will tell us that there are now no cookies here for this webpage.</p><figure name="4810" id="4810" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*iFupkkIwm9eNYzZQZEBm0Q.png" data-width="1948" data-height="496" src="https://cdn-images-1.medium.com/max/800/1*iFupkkIwm9eNYzZQZEBm0Q.png"></figure><p name="6a79" id="6a79" class="graf graf--p graf-after--figure">Secondly, we enter Hello again and we can find out that Hello is being set for the userID.</p><figure name="0043" id="0043" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bm2NdmVW6sVk1Pl31WMvUg.png" data-width="1948" data-height="858" src="https://cdn-images-1.medium.com/max/800/1*bm2NdmVW6sVk1Pl31WMvUg.png"></figure><p name="05c3" id="05c3" class="graf graf--p graf-after--figure">Thirdly, we change the value of the userID to Hi and click on the green √ sign to save this value.</p><figure name="6939" id="6939" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*S5L0WDPJNdtk9WbXPn4IQQ.png" data-width="1948" data-height="858" src="https://cdn-images-1.medium.com/max/800/1*S5L0WDPJNdtk9WbXPn4IQQ.png"></figure><p name="de53" id="de53" class="graf graf--p graf-after--figure">Finally, we click on the link to read the cookie. Then we can find out the userID for us is no longer Hello and we cheated the server and login with the identity of another user.</p><figure name="5807" id="5807" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TeHiiuFgHnV3mlxkr3pJ-A.png" data-width="1996" data-height="888" src="https://cdn-images-1.medium.com/max/800/1*TeHiiuFgHnV3mlxkr3pJ-A.png"></figure><p name="ad38" id="ad38" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">4. Session Cookie</strong></p><p name="9a64" id="9a64" class="graf graf--p graf-after--p">For server developers, they don’t want to store the key information of a user in the browser and there are two reasons. Firstly, the users can change the information and cheat the server (as we have done). Secondly, there can be too many cookies for uploading and it will take forever and not secure if all the cookies with sensitive data are uploaded for every request. That’s why we have the concept of sessions for this.</p><p name="433b" id="433b" class="graf graf--p graf-after--p">The sessions are information stored on the server instead of the users’ computer. Well, the user does have a cookie and this cookie always has no specific meaning (it is actually a hash value). For example,</p><pre name="9fdc" id="9fdc" class="graf graf--pre graf-after--p">eyJwYXNzd29yZCI6InNkcyIsInVzZXJuYW1lIjoieWltIn0.X7_lSQ.2eR_3gbFtfnnYxoZaT756HJTMUA</pre><p name="84d9" id="84d9" class="graf graf--p graf-after--pre">However, the server uses this key to identify the users and then calls the information of this specific user from the server.</p><figure name="3c0b" id="3c0b" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/Sadamingh/ff391f7b0623eeeeda8705385279ba4b.js"></script></figure><p name="4a58" id="4a58" class="graf graf--p graf-after--figure">Again, we run this script and then go to,</p><pre name="fe80" id="fe80" class="graf graf--pre graf-after--p">&lt;server ip&gt;:5000</pre><p name="b781" id="b781" class="graf graf--p graf-after--pre">For the root page, it is said that we are not logged in. Then we can click on the link to log in.</p><figure name="9a4e" id="9a4e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4-8Yc8ANPmZjTSc6ObSFRg.png" data-width="1666" data-height="486" src="https://cdn-images-1.medium.com/max/800/1*4-8Yc8ANPmZjTSc6ObSFRg.png"></figure><p name="a744" id="a744" class="graf graf--p graf-after--figure">On the login page, it is said that we have to type in the userID and password in order to login. However, this is not a real server so it will not verify the account. We can also discover that there is no cookie at this moment.</p><figure name="e4b1" id="e4b1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*tQEBzUnLLd0lxT41FUwoeQ.png" data-width="2038" data-height="486" src="https://cdn-images-1.medium.com/max/800/1*tQEBzUnLLd0lxT41FUwoeQ.png"></figure><p name="8177" id="8177" class="graf graf--p graf-after--figure">Now, let’s randomly type in the userID and the password, for example,</p><pre name="0d7c" id="0d7c" class="graf graf--pre graf-after--p">userID: admin<br>password: admin123pass</pre><figure name="451a" id="451a" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*HGuTGgPvbg-ceW3JDgBcXw.png" data-width="1840" data-height="486" src="https://cdn-images-1.medium.com/max/800/1*HGuTGgPvbg-ceW3JDgBcXw.png"></figure><p name="b866" id="b866" class="graf graf--p graf-after--figure">Then we click on the button login to continue.</p><figure name="d861" id="d861" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*a77VJTAcF8T3ZAiLKSsRRQ.png" data-width="1804" data-height="878" src="https://cdn-images-1.medium.com/max/800/1*a77VJTAcF8T3ZAiLKSsRRQ.png"></figure><p name="bf75" id="bf75" class="graf graf--p graf-after--figure">Then we will get a session value (key).</p><pre name="5c95" id="5c95" class="graf graf--pre graf-after--p">eyJwYXNzd29yZCI6ImFkbWluMTIzcGFzcyIsInVzZXJuYW1lIjoiYWRtaW4ifQ.X7_oLA.AMDXgRqDl4A0FZ-BvGnhXeqJuQA</pre><p name="6e31" id="6e31" class="graf graf--p graf-after--pre">You can discover that this value is the same as my value. This is because we have the same app.secret_key, the same userID, and the same password, then our hash value for this instance should then be the same.</p><p name="beb1" id="beb1" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">6. Cookie Forgery 2: Cheat The Server with Session Cookie</strong></p><p name="2c32" id="2c32" class="graf graf--p graf-after--p">Even though it is much safer because if the user doesn’t know the secret key of the server, they can hardly know the meaning of the session value. And the session cookies make it harder for hackers to modify the cookies because there are no sensitive data in the cookie (only the server will know the meaning of these cookies).</p><p name="c837" id="c837" class="graf graf--p graf-after--p">However, the cookie session is still not safe because it can be leaked and someone can thus log in with your account. Let’s try this now.</p><p name="cd3c" id="cd3c" class="graf graf--p graf-after--p">Suppose that I am a client user and I am not the admin. But by some means, I got the admin’s cookie as,</p><pre name="a65e" id="a65e" class="graf graf--pre graf-after--p">eyJwYXNzd29yZCI6ImFkbWluMTIzcGFzcyIsInVzZXJuYW1lIjoiYWRtaW4ifQ.X7_oLA.AMDXgRqDl4A0FZ-BvGnhXeqJuQA</pre><p name="e3f8" id="e3f8" class="graf graf--p graf-after--pre">I firstly log in with my account,</p><figure name="ef81" id="ef81" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wNHY-L6-P3PgLWYM3B33Og.png" data-width="1712" data-height="376" src="https://cdn-images-1.medium.com/max/800/1*wNHY-L6-P3PgLWYM3B33Og.png"></figure><figure name="38e9" id="38e9" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*ebkGeth6vyOfocE9pEHSvA.png" data-width="1712" data-height="874" src="https://cdn-images-1.medium.com/max/800/1*ebkGeth6vyOfocE9pEHSvA.png"></figure><p name="21d4" id="21d4" class="graf graf--p graf-after--figure">And then change my cookie to the admin’s cookie,</p><figure name="4d54" id="4d54" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*-8kTqlVhrFHH1damas8YTw.png" data-width="1712" data-height="874" src="https://cdn-images-1.medium.com/max/800/1*-8kTqlVhrFHH1damas8YTw.png"></figure><p name="0279" id="0279" class="graf graf--p graf-after--figure">Click on the green √ sign to save this value and then refresh the page.</p><figure name="fe26" id="fe26" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*BtyDoWh1KO2LUCVnQS-l0g.png" data-width="1712" data-height="874" src="https://cdn-images-1.medium.com/max/800/1*BtyDoWh1KO2LUCVnQS-l0g.png"></figure><p name="b97a" id="b97a" class="graf graf--p graf-after--figure graf--trailing">Now we can see the password of the admin. That’s why a leaked cookie value can be really dangerous for us!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/60ca30549edb"><time class="dt-published" datetime="2020-11-26T18:00:17.715Z">November 26, 2020</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/data-acquisition-8-internet-cookies-60ca30549edb" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>