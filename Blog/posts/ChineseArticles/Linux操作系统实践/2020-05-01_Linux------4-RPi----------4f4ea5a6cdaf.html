<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Linux操作系统实践4 RPi开发工具和环境配置</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Linux操作系统实践4 RPi开发工具和环境配置</h1>
</header>
<section data-field="subtitle" class="p-summary">
系列：操作系统实践
</section>
<section data-field="body" class="e-content">
<section name="5dd6" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="bfc1" id="bfc1" class="graf graf--h3 graf--leading graf--title">Linux操作系统实践4 RPi开发工具和环境配置</h3><figure name="26e3" id="26e3" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*beSHA3cQNnPOOKl4ypDgfw.jpeg" data-width="2689" data-height="1513" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*beSHA3cQNnPOOKl4ypDgfw.jpeg"></figure><p name="c7e9" id="c7e9" class="graf graf--p graf-after--figure">下面的教程全部在MacOS和Linux系统上实现。对于Windows系统，请参考：<a href="http://cs107e.github.io/guides/install/wsl/" data-href="http://cs107e.github.io/guides/install/wsl/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">http://cs107e.github.io/guides/install/wsl/</a>。</p><p name="a855" id="a855" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">一、Homebrew配置</strong></p><p name="d0a9" id="d0a9" class="graf graf--p graf-after--p">首先检查Homebrew，在命令行输入：</p><pre name="3cbe" id="3cbe" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ brew -v</code></pre><p name="f1fd" id="f1fd" class="graf graf--p graf-after--pre">如果输出了版本号，则可以跳过下面两个步骤，否则执行下面两个步骤。</p><ol class="postList"><li name="a699" id="a699" class="graf graf--li graf-after--p">安装Xcode命令行工具</li></ol><pre name="5fa7" id="5fa7" class="graf graf--pre graf-after--li"><code class="markup--code markup--pre-code">$ xcode-select --install</code></pre><p name="405b" id="405b" class="graf graf--p graf-after--pre">2. 安装Homebrew安装包管理工具</p><pre name="bfc2" id="bfc2" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></pre><p name="1e50" id="1e50" class="graf graf--p graf-after--pre">安装成功之后我们仍然要检查版本，以便确认已经成功安装Homebrew。</p><p name="03df" id="03df" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">二、安装arm-none-eabi工具链</strong></p><p name="8b2a" id="8b2a" class="graf graf--p graf-after--p">我们需要的arm-none-eabi被Stanford CS107E课程（我非常感谢Stanford大学的开放价值观）存储在Homebrew上（我们可以在Homebrew上找到它！）：</p><figure name="82d1" id="82d1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WkLmbV3d-34OzAACnKJ4nQ.png" data-width="1686" data-height="678" src="https://cdn-images-1.medium.com/max/800/1*WkLmbV3d-34OzAACnKJ4nQ.png"><figcaption class="imageCaption"><a href="https://brew.sh/" data-href="https://brew.sh/" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">https://brew.sh/</a></figcaption></figure><p name="cf08" id="cf08" class="graf graf--p graf-after--figure">我们通过下面的步骤来安装工具链：</p><ol class="postList"><li name="dce3" id="dce3" class="graf graf--li graf-after--p">进入cs107e目录</li></ol><pre name="af4e" id="af4e" class="graf graf--pre graf-after--li"><code class="markup--code markup--pre-code">$ brew tap cs107e/cs107e</code></pre><p name="c76c" id="c76c" class="graf graf--p graf-after--pre">2. 安装目录中的arm-none-eabi工具</p><pre name="4955" id="4955" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ brew install arm-none-eabi</code></pre><p name="3911" id="3911" class="graf graf--p graf-after--pre">3. 检查工具链的安装</p><pre name="31ce" id="31ce" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ arm-none-eabi-gcc --version</code></pre><p name="03f2" id="03f2" class="graf graf--p graf-after--pre">如果我们能够得到工具的版本号，那么证明我们已经成功安装了arm-none-eabi工具链。</p><p name="6514" id="6514" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">三、安装CP2102串口驱动控制程序</strong></p><p name="57d3" id="57d3" class="graf graf--p graf-after--p">控制台驱动程序使引导加载程序客户端能够通过USB串行设备与Raspberry Pi进行通信。</p><p name="6627" id="6627" class="graf graf--p graf-after--p">我们通过下面的步骤来安装CP210X系列USB串口的驱动程序。</p><ol class="postList"><li name="7457" id="7457" class="graf graf--li graf-after--p">下载CP210X驱动程序。</li></ol><p name="50a5" id="50a5" class="graf graf--p graf-after--li">我们从<a href="https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers" data-href="https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SiliconLabs</a>的官网上下载针对CP210X串口的驱动程序。我们选择的是Macintosh OSX（v5.2.4）版本的下载。下载完成后，我们解压下载好的zip文件并得到dmg文件 <code class="markup--code markup--p-code">SiLabsUSBDriverDisk.dmg</code>。打开这个dmg文件以找到文件<code class="markup--code markup--p-code">Silicon Labs VCP Driver Installer Disk</code>。</p><p name="dac2" id="dac2" class="graf graf--p graf-after--p">2. 在打开的卷中，我们找到 <code class="markup--code markup--p-code">Install CP2010x VCP Driver</code>文件并安装。如果提示隐私和安全问题，请在系统偏好设置中允许开发者。</p><p name="52e8" id="52e8" class="graf graf--p graf-after--p">3. 检查CP2102串口驱动的安装</p><pre name="5522" id="5522" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">kextfind -B -s SiLabs -report -b -loadable</code></pre><p name="7924" id="7924" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">四、安装Python3和两个pkg</strong></p><p name="0658" id="0658" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">rpi-install.py</code>脚本可以用于将电脑上的程序传输到Raspberry Pi上。该脚本需要在电脑上预先安装python3和两个pkg模块。Mac随附安装了python版本，但它是较旧的版本（版本2），即将到期。您需要python3。如果您以前已经安装了python3，请跳过下面的步骤1。</p><ol class="postList"><li name="a3ce" id="a3ce" class="graf graf--li graf-after--p">安装Python3</li></ol><p name="ca87" id="ca87" class="graf graf--p graf-after--li">安装python3。可从<a href="https://www.python.org/downloads/mac-osx/" data-href="https://www.python.org/downloads/mac-osx/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://www.python.org/downloads/mac-osx/</a>获得Python安装程序。选择最新的稳定Python 3版本并下载其macOS 64位安装程序。打开下载的pkg文件，然后按照说明安装python3。</p><p name="7e2a" id="7e2a" class="graf graf--p graf-after--p">2. 确认Python3的安装</p><pre name="63a5" id="63a5" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">python3 --version</code></pre><p name="f2cf" id="f2cf" class="graf graf--p graf-after--pre">3. 为python3安装pyserial和xmodem软件包</p><pre name="a5a6" id="a5a6" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">python3 -m pip install pyserial xmodem</code></pre><p name="b777" id="b777" class="graf graf--p graf-after--pre">你可能会收到关于pip包过期的警告，可以选择更新也可以选择忽略，这不重要。</p><p name="3f5a" id="3f5a" class="graf graf--p graf-after--p">4. 确认<code class="markup--code markup--p-code">pyserial</code>并<code class="markup--code markup--p-code">xmodem</code>列出为python3的已安装软件包：</p><pre name="785c" id="785c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ python3 -m pip list</code></pre><p name="3e23" id="3e23" class="graf graf--p graf-after--pre">在输出的包中找<code class="markup--code markup--p-code">pyserial</code>和<code class="markup--code markup--p-code">xmodem</code></p><pre name="b7f5" id="b7f5" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">Package    Version<br> ---------- -------<br> pyserial   3.4    <br> xmodem     0.4.5</code></pre><p name="c8d5" id="c8d5" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">五、配置环境</strong></p><p name="21c9" id="21c9" class="graf graf--p graf-after--p">我们为我们所有的文件和shell配置下面的环境：</p><ol class="postList"><li name="9e3f" id="9e3f" class="graf graf--li graf-after--p">在Home设置目录，名字为<code class="markup--code markup--li-code">cs107e_home</code>，也可以为其他的</li></ol><pre name="300c" id="300c" class="graf graf--pre graf-after--li"><code class="markup--code markup--pre-code">$ mkdir ~/cs107e_home</code></pre><p name="6e68" id="6e68" class="graf graf--p graf-after--pre">2. 从Stanford的CS 107E中clone仓库</p><pre name="f78d" id="f78d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ cd ~/cs107e_home<br>$ git clone https://github.com/cs107e/cs107e.github.io</code></pre><p name="9f42" id="9f42" class="graf graf--p graf-after--pre">3. 检查确认cs107e_home：</p><pre name="a98c" id="a98c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ ls ~/cs107e_home/cs107e.github.io/cs107e/</code></pre><p name="8ec9" id="8ec9" class="graf graf--p graf-after--pre">输出结果应该为：</p><pre name="451f" id="451f" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">bin/    examples/   extras/     include/    lib/    sample_build/   src/</code></pre><p name="8772" id="8772" class="graf graf--p graf-after--pre">4. 查看Shell（这里只考虑bash作为shell的情况）：</p><pre name="a52d" id="a52d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">echo $SHELL</code></pre><p name="7f67" id="7f67" class="graf graf--p graf-after--pre">5. 查看Shell的配置文件，我们找到.bash开头的即可</p><pre name="68cb" id="68cb" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ cd ~<br>$ ls -a .bash* </code></pre><p name="30ed" id="30ed" class="graf graf--p graf-after--pre">我们期待找到一个名字为<code class="markup--code markup--p-code">.bashrc</code>的配置文件。如果没有，我们可以通过下面的命令新建一个：</p><pre name="4669" id="4669" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ touch .bashrc</code></pre><p name="ed00" id="ed00" class="graf graf--p graf-after--pre">6. 使用Vim打开配置文件<code class="markup--code markup--p-code">.bashrc</code>，并在最后输入下面的两行语句：</p><pre name="8394" id="8394" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">export CS107E=~/cs107e_home/cs107e.github.io/cs107e<br>export PATH=$PATH:$CS107E/bin</code></pre><p name="2171" id="2171" class="graf graf--p graf-after--pre">第一行将环境变量设置为储存文件的目标位置。第二行将CS107E提供的bin子目录添加到执行环境中去。</p><p name="56fc" id="56fc" class="graf graf--p graf-after--p">我们可以使用source命令立刻在当前shall中重新读取配置。</p><pre name="25ee" id="25ee" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ source ~/.bashrc</code></pre><p name="266c" id="266c" class="graf graf--p graf-after--pre">7. 检查Shell配置，我们要求这里的输出结果和我们给出的完全相同：</p><p name="58ce" id="58ce" class="graf graf--p graf-after--p">（1）输入：</p><pre name="0f2a" id="0f2a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ echo $CS107E</code></pre><p name="5265" id="5265" class="graf graf--p graf-after--pre">输出：</p><pre name="6253" id="6253" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">/Users/student/cs107e_home/cs107e.github.io/cs107e</code></pre><p name="b705" id="b705" class="graf graf--p graf-after--pre">（2）输入：</p><pre name="5270" id="5270" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ ls $CS107E/lib/libpi.a</code></pre><p name="7ad3" id="7ad3" class="graf graf--p graf-after--pre">输出：</p><pre name="9655" id="9655" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">/Users/student/cs107e_home/cs107e.github.io/cs107e/lib/libpi.a</code></pre><p name="c9b9" id="c9b9" class="graf graf--p graf-after--pre">（3）输入：</p><pre name="c7d0" id="c7d0" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ which pinout</code></pre><p name="0634" id="0634" class="graf graf--p graf-after--pre">输出：</p><pre name="c42d" id="c42d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">/Users/student/cs107e_home/cs107e.github.io/cs107e/bin/pinout</code></pre><p name="9827" id="9827" class="graf graf--p graf-after--pre">8. 对于Mac系统，我们还需要在.bash_profile文件中添加一行。如果在～没有这个文件，我们需要同样拿touch命令创建一个空文件。我们通过Vim在该文件的最后添加：</p><pre name="4622" id="4622" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">source ~/.bashrc</code></pre><p name="65bb" id="65bb" class="graf graf--p graf-after--pre">9. 关闭当前的Shell并打开一个新的Shell，我们重复步骤7，确保新的Shell也被同样配置了。</p><p name="5437" id="5437" class="graf graf--p graf-after--p">10. 配置git身份。我们可以通过下面的语句更新自己的git身份：</p><pre name="23fe" id="23fe" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ git config --global user.name &quot;My Name&quot;<br>$ git config --global user.email my@email.com</code></pre><p name="9c94" id="9c94" class="graf graf--p graf-after--pre">11. 检查git身份是否成功配置</p><pre name="4c89" id="4c89" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">git config --get-regexp user</code></pre><p name="6ace" id="6ace" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">六、检查表 Check List</strong></p><p name="4acb" id="4acb" class="graf graf--p graf-after--p">为了确保后面的内容万无一失，我们可以通过下面的检查来确定之前的所有操作是否成功完成：</p><ol class="postList"><li name="f387" id="f387" class="graf graf--li graf-after--p">检查<code class="markup--code markup--li-code">arm-none-eabi</code>工具链</li></ol><pre name="5465" id="5465" class="graf graf--pre graf-after--li"><code class="markup--code markup--pre-code">$ arm-none-eabi-as --version</code></pre><p name="f06a" id="f06a" class="graf graf--p graf-after--pre">确保版本号大于等于v2.24</p><p name="8845" id="8845" class="graf graf--p graf-after--p">2. 检查ARM仿真器可用</p><pre name="f93a" id="f93a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ arm-none-eabi-gdb</code></pre><p name="7d01" id="7d01" class="graf graf--p graf-after--pre">需要的输出结果：</p><pre name="b907" id="b907" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">GNU gdb (GDB) 7.8.1<br>Copyright (C) 2014 Free Software Foundation, Inc.<br> .... blah blah blah ...</code></pre><pre name="fb4d" id="fb4d" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">(gdb) target sim<br>Connected to the simulator.</code></pre><pre name="841e" id="841e" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">(gdb) quit</code></pre><p name="b160" id="b160" class="graf graf--p graf-after--pre">3. 检查rpi-install.py脚本可用情况</p><pre name="4cc6" id="4cc6" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ rpi-install.py -h</code></pre><p name="631d" id="631d" class="graf graf--p graf-after--pre">确保为v1.1版本。</p><p name="e325" id="e325" class="graf graf--p graf-after--p">4. 检查环境变量，是否能够根据相对地址找到绝对地址：</p><pre name="8b69" id="8b69" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ ls $CS107E/lib/libpi.a</code></pre><p name="4e57" id="4e57" class="graf graf--p graf-after--pre">输出：</p><pre name="159a" id="159a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">/Users/myname/cs107e_home/cs107e.github.io/cs107e/lib/libpi.a</code></pre><p name="69c3" id="69c3" class="graf graf--p graf-after--pre">5. 检查Path</p><pre name="5ec0" id="5ec0" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ pinout</code></pre><p name="5da6" id="5da6" class="graf graf--p graf-after--pre">输出：</p><pre name="ecd9" id="ecd9" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ pinout<br>O-------------------------------O<br>| oooooooooooooooooooo J8       |<br>| 1ooooooooooooooooooo          |<br>|                               |<br>|[RUN]   Pi Model A+ V1.1   +=====<br>...</code></pre><p name="3bbe" id="3bbe" class="graf graf--p graf-after--pre">6. 检查git身份</p><pre name="5acb" id="5acb" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ git config --get-regexp user</code></pre><p name="7cca" id="7cca" class="graf graf--p graf-after--pre">输出：</p><pre name="b6d0" id="b6d0" class="graf graf--pre graf-after--p graf--trailing"><code class="markup--code markup--pre-code">user.name My Full Name<br>user.email my@email.com</code></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@adamedelweiss" class="p-author h-card">Adam Edelweiss</a> on <a href="https://medium.com/p/4f4ea5a6cdaf"><time class="dt-published" datetime="2020-05-01T15:54:28.705Z">May 1, 2020</time></a>.</p><p><a href="https://medium.com/@adamedelweiss/linux%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E8%B7%B54-rpi%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E5%92%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-4f4ea5a6cdaf" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 15, 2021.</p></footer></article></body></html>